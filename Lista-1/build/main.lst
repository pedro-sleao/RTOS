GAS LISTING /tmp/ccsBKM5i.s 			page 1


   1               		.file	"main.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.stabs	"/home/pedro/Documentos/2024.1/RTOS/Lista-1/",100,0,2,.Ltext0
   8               		.stabs	"main.c",100,0,2,.Ltext0
   9               		.text
  10               	.Ltext0:
  11               		.stabs	"gcc2_compiled.",60,0,0,0
  12               		.stabs	"int:t(0,1)=r(0,1);-32768;32767;",128,0,0,0
  13               		.stabs	"char:t(0,2)=@s8;r(0,2);0;255;",128,0,0,0
  14               		.stabs	"long int:t(0,3)=@s32;r(0,3);020000000000;017777777777;",128,0,0,0
  15               		.stabs	"unsigned int:t(0,4)=r(0,4);0;0177777;",128,0,0,0
  16               		.stabs	"long unsigned int:t(0,5)=@s32;r(0,5);0;037777777777;",128,0,0,0
  17               		.stabs	"__int128:t(0,6)=@s128;r(0,6);02000000000000000000000000000000000000000000;0177777777777777
  18               		.stabs	"__int128 unsigned:t(0,7)=@s128;r(0,7);0;03777777777777777777777777777777777777777777;",128
  19               		.stabs	"long long int:t(0,8)=@s64;r(0,8);01000000000000000000000;00777777777777777777777;",128,0,0
  20               		.stabs	"long long unsigned int:t(0,9)=@s64;r(0,9);0;01777777777777777777777;",128,0,0,0
  21               		.stabs	"short int:t(0,10)=r(0,10);-32768;32767;",128,0,0,0
  22               		.stabs	"short unsigned int:t(0,11)=r(0,11);0;0177777;",128,0,0,0
  23               		.stabs	"signed char:t(0,12)=@s8;r(0,12);-128;127;",128,0,0,0
  24               		.stabs	"unsigned char:t(0,13)=@s8;r(0,13);0;255;",128,0,0,0
  25               		.stabs	"float:t(0,14)=r(0,1);4;0;",128,0,0,0
  26               		.stabs	"double:t(0,15)=r(0,1);4;0;",128,0,0,0
  27               		.stabs	"long double:t(0,16)=r(0,1);4;0;",128,0,0,0
  28               		.stabs	"_Float32:t(0,17)=r(0,1);4;0;",128,0,0,0
  29               		.stabs	"short _Fract:t(0,18)=r(0,1);1;0;",128,0,0,0
  30               		.stabs	"_Fract:t(0,19)=r(0,1);2;0;",128,0,0,0
  31               		.stabs	"long _Fract:t(0,20)=r(0,1);4;0;",128,0,0,0
  32               		.stabs	"long long _Fract:t(0,21)=r(0,1);8;0;",128,0,0,0
  33               		.stabs	"unsigned short _Fract:t(0,22)=r(0,1);1;0;",128,0,0,0
  34               		.stabs	"unsigned _Fract:t(0,23)=r(0,1);2;0;",128,0,0,0
  35               		.stabs	"unsigned long _Fract:t(0,24)=r(0,1);4;0;",128,0,0,0
  36               		.stabs	"unsigned long long _Fract:t(0,25)=r(0,1);8;0;",128,0,0,0
  37               		.stabs	"_Sat short _Fract:t(0,26)=r(0,1);1;0;",128,0,0,0
  38               		.stabs	"_Sat _Fract:t(0,27)=r(0,1);2;0;",128,0,0,0
  39               		.stabs	"_Sat long _Fract:t(0,28)=r(0,1);4;0;",128,0,0,0
  40               		.stabs	"_Sat long long _Fract:t(0,29)=r(0,1);8;0;",128,0,0,0
  41               		.stabs	"_Sat unsigned short _Fract:t(0,30)=r(0,1);1;0;",128,0,0,0
  42               		.stabs	"_Sat unsigned _Fract:t(0,31)=r(0,1);2;0;",128,0,0,0
  43               		.stabs	"_Sat unsigned long _Fract:t(0,32)=r(0,1);4;0;",128,0,0,0
  44               		.stabs	"_Sat unsigned long long _Fract:t(0,33)=r(0,1);8;0;",128,0,0,0
  45               		.stabs	"short _Accum:t(0,34)=r(0,1);2;0;",128,0,0,0
  46               		.stabs	"_Accum:t(0,35)=r(0,1);4;0;",128,0,0,0
  47               		.stabs	"long _Accum:t(0,36)=r(0,1);8;0;",128,0,0,0
  48               		.stabs	"long long _Accum:t(0,37)=r(0,1);8;0;",128,0,0,0
  49               		.stabs	"unsigned short _Accum:t(0,38)=r(0,1);2;0;",128,0,0,0
  50               		.stabs	"unsigned _Accum:t(0,39)=r(0,1);4;0;",128,0,0,0
  51               		.stabs	"unsigned long _Accum:t(0,40)=r(0,1);8;0;",128,0,0,0
  52               		.stabs	"unsigned long long _Accum:t(0,41)=r(0,1);8;0;",128,0,0,0
  53               		.stabs	"_Sat short _Accum:t(0,42)=r(0,1);2;0;",128,0,0,0
  54               		.stabs	"_Sat _Accum:t(0,43)=r(0,1);4;0;",128,0,0,0
  55               		.stabs	"_Sat long _Accum:t(0,44)=r(0,1);8;0;",128,0,0,0
  56               		.stabs	"_Sat long long _Accum:t(0,45)=r(0,1);8;0;",128,0,0,0
  57               		.stabs	"_Sat unsigned short _Accum:t(0,46)=r(0,1);2;0;",128,0,0,0
GAS LISTING /tmp/ccsBKM5i.s 			page 2


  58               		.stabs	"_Sat unsigned _Accum:t(0,47)=r(0,1);4;0;",128,0,0,0
  59               		.stabs	"_Sat unsigned long _Accum:t(0,48)=r(0,1);8;0;",128,0,0,0
  60               		.stabs	"_Sat unsigned long long _Accum:t(0,49)=r(0,1);8;0;",128,0,0,0
  61               		.stabs	"void:t(0,50)=(0,50)",128,0,0,0
  62               		.stabs	"/usr/lib/avr/include/avr/io.h",130,0,0,0
  63               		.stabs	"/usr/lib/avr/include/avr/sfr_defs.h",130,0,0,0
  64               		.stabs	"/usr/lib/avr/include/inttypes.h",130,0,0,0
  65               		.stabs	"/usr/lib/gcc/avr/7.3.0/include/stdint.h",130,0,0,0
  66               		.stabs	"/usr/lib/avr/include/stdint.h",130,0,0,0
  67               		.stabs	"int8_t:t(5,1)=(0,12)",128,0,125,0
  68               		.stabs	"uint8_t:t(5,2)=(0,13)",128,0,126,0
  69               		.stabs	"int16_t:t(5,3)=(0,1)",128,0,127,0
  70               		.stabs	"uint16_t:t(5,4)=(0,4)",128,0,128,0
  71               		.stabs	"int32_t:t(5,5)=(0,3)",128,0,129,0
  72               		.stabs	"uint32_t:t(5,6)=(0,5)",128,0,130,0
  73               		.stabs	"int64_t:t(5,7)=(0,8)",128,0,132,0
  74               		.stabs	"uint64_t:t(5,8)=(0,9)",128,0,133,0
  75               		.stabs	"intptr_t:t(5,9)=(5,3)",128,0,146,0
  76               		.stabs	"uintptr_t:t(5,10)=(5,4)",128,0,151,0
  77               		.stabs	"int_least8_t:t(5,11)=(5,1)",128,0,163,0
  78               		.stabs	"uint_least8_t:t(5,12)=(5,2)",128,0,168,0
  79               		.stabs	"int_least16_t:t(5,13)=(5,3)",128,0,173,0
  80               		.stabs	"uint_least16_t:t(5,14)=(5,4)",128,0,178,0
  81               		.stabs	"int_least32_t:t(5,15)=(5,5)",128,0,183,0
  82               		.stabs	"uint_least32_t:t(5,16)=(5,6)",128,0,188,0
  83               		.stabs	"int_least64_t:t(5,17)=(5,7)",128,0,196,0
  84               		.stabs	"uint_least64_t:t(5,18)=(5,8)",128,0,203,0
  85               		.stabs	"int_fast8_t:t(5,19)=(5,1)",128,0,217,0
  86               		.stabs	"uint_fast8_t:t(5,20)=(5,2)",128,0,222,0
  87               		.stabs	"int_fast16_t:t(5,21)=(5,3)",128,0,227,0
  88               		.stabs	"uint_fast16_t:t(5,22)=(5,4)",128,0,232,0
  89               		.stabs	"int_fast32_t:t(5,23)=(5,5)",128,0,237,0
  90               		.stabs	"uint_fast32_t:t(5,24)=(5,6)",128,0,242,0
  91               		.stabs	"int_fast64_t:t(5,25)=(5,7)",128,0,250,0
  92               		.stabs	"uint_fast64_t:t(5,26)=(5,8)",128,0,257,0
  93               		.stabs	"intmax_t:t(5,27)=(5,7)",128,0,277,0
  94               		.stabs	"uintmax_t:t(5,28)=(5,8)",128,0,282,0
  95               		.stabn	162,0,0,0
  96               		.stabn	162,0,0,0
  97               		.stabs	"int_farptr_t:t(3,1)=(5,5)",128,0,77,0
  98               		.stabs	"uint_farptr_t:t(3,2)=(5,6)",128,0,81,0
  99               		.stabn	162,0,0,0
 100               		.stabn	162,0,0,0
 101               		.stabs	"/usr/lib/avr/include/avr/fuse.h",130,0,0,0
 102               		.stabs	"__fuse_t:t(6,1)=(6,2)=s3low:(0,13),0,8;high:(0,13),8,8;extended:(0,13),16,8;;",128,0,244,0
 103               		.stabn	162,0,0,0
 104               		.stabn	162,0,0,0
 105               		.stabs	"/usr/lib/avr/include/string.h",130,0,0,0
 106               		.stabs	"/usr/lib/gcc/avr/7.3.0/include/stddef.h",130,0,0,0
 107               		.stabs	"size_t:t(8,1)=(0,4)",128,0,216,0
 108               		.stabn	162,0,0,0
 109               		.stabn	162,0,0,0
 110               		.stabs	"__vector_19:F(0,50)",36,0,75,__vector_19
 111               	.global	__vector_19
 112               		.type	__vector_19, @function
 113               	__vector_19:
 114               		.stabd	46,0,0
GAS LISTING /tmp/ccsBKM5i.s 			page 3


   1:main.c        **** /**
   2:main.c        ****  * Lista 1
   3:main.c        ****  * Autor: Pedro Lucas de Souza Le√£o
   4:main.c        ****  */
   5:main.c        **** 
   6:main.c        **** /* Necess√°rio para fun√ß√µes e macros b√°sicas */
   7:main.c        **** #include <avr/io.h>
   8:main.c        **** 
   9:main.c        **** /* Os pr√≥ximos dois includes s√£o necess√°rios quando se usa interrup√ßoes */
  10:main.c        **** #include <avr/cpufunc.h>
  11:main.c        **** #include <avr/interrupt.h>
  12:main.c        **** 
  13:main.c        **** #include <stdint.h>
  14:main.c        **** #include <string.h>
  15:main.c        **** 
  16:main.c        **** #define FOSC 16000000ul
  17:main.c        **** #define BAUD 9600
  18:main.c        **** #define MYUBRR (FOSC/(8ul*BAUD) - 1)
  19:main.c        **** #define BUFFER_SIZE 255
  20:main.c        **** 
  21:main.c        **** /* Caracteres especiais */
  22:main.c        **** #define SINC 0x7e
  23:main.c        **** #define XON 0x11
  24:main.c        **** #define XOFF 0x13
  25:main.c        **** #define ESC 0x7d
  26:main.c        **** 
  27:main.c        **** /* Prot√≥tipos das fun√ß√µes */
  28:main.c        **** uint8_t write(uint8_t* buf, uint8_t n, int8_t close_packet);
  29:main.c        **** uint8_t read(uint8_t* buf, uint8_t n);
  30:main.c        **** uint16_t read_rx_buffer(void);
  31:main.c        **** uint8_t write_tx_buffer(uint8_t c);
  32:main.c        **** void enqueue_rx_buffer(uint8_t received_data);
  33:main.c        **** void flow_off(void);
  34:main.c        **** void flow_on(void);
  35:main.c        **** uint8_t is_flow_on(void);
  36:main.c        **** void delay_ms(uint16_t ms);
  37:main.c        **** void blink_led(void);
  38:main.c        **** void turn_led_on(void);
  39:main.c        **** uint8_t received_data(void);
  40:main.c        **** void reset_rxbuffer(void);
  41:main.c        **** 
  42:main.c        **** /* Vari√°veis globais */
  43:main.c        **** uint8_t rx_byte_cnt, tx_byte_cnt;
  44:main.c        **** uint8_t rx_esc, rx_state=1, rx_sinc, tx_state=1;
  45:main.c        **** uint8_t rx_buffer[BUFFER_SIZE]; /* buffer para recep√ß√£o */
  46:main.c        **** uint8_t rx_head, rx_tail; /* ponteiros para o buffer circular */
  47:main.c        **** uint8_t tx_buffer[BUFFER_SIZE];     /* buffer para transmiss√£o */
  48:main.c        **** uint8_t tx_head, tx_tail;   /* ponteiros para o buffer circular */
  49:main.c        **** uint8_t usart_transmitting;
  50:main.c        **** 
  51:main.c        **** volatile uint8_t rcvd_byte=0;
  52:main.c        **** ISR(USART_RX_vect) {
  53:main.c        ****     uint8_t received_data = UDR0;
  54:main.c        ****     
  55:main.c        ****     if (!rx_esc) {
  56:main.c        ****         if (received_data == ESC) {
  57:main.c        ****             rx_esc = 1;
GAS LISTING /tmp/ccsBKM5i.s 			page 4


  58:main.c        ****         } else if (received_data == XOFF) {
  59:main.c        ****             tx_state = 0;
  60:main.c        ****         } else if (received_data == XON) {
  61:main.c        ****             tx_state = 1;
  62:main.c        ****         } else if (received_data == SINC){
  63:main.c        ****             rx_sinc = 1;
  64:main.c        ****             rcvd_byte = 1;
  65:main.c        ****         } else {
  66:main.c        ****             enqueue_rx_buffer(received_data);
  67:main.c        ****         }
  68:main.c        ****     } else {
  69:main.c        ****         enqueue_rx_buffer(received_data);
  70:main.c        ****         rx_esc = 0;
  71:main.c        ****     }
  72:main.c        **** }
  73:main.c        **** 
  74:main.c        **** /* Flag UDREn indica se o buffer de transmiss√£o UDRn est√° vazio */
  75:main.c        **** ISR(USART_UDRE_vect)
  76:main.c        **** {
 115               		.stabn	68,0,76,.LM0-.LFBB1
 116               	.LM0:
 117               	.LFBB1:
 118 0000 1F92      		push r1
 119 0002 0F92      		push r0
 120 0004 0FB6      		in r0,__SREG__
 121 0006 0F92      		push r0
 122 0008 1124      		clr __zero_reg__
 123 000a 8F93      		push r24
 124 000c EF93      		push r30
 125 000e FF93      		push r31
 126               	/* prologue: Signal */
 127               	/* frame size = 0 */
 128               	/* stack size = 6 */
 129               	.L__stack_usage = 6
  77:main.c        ****     /*
  78:main.c        ****      * Caso tx_head == tx_tail √© porque todos os dados foram transmitidos e desabilita a interrup√
  79:main.c        ****      * Caso contr√°rio envia o dado que estava no tx_tail
  80:main.c        ****      */
  81:main.c        ****     if (tx_head == tx_tail) {
 130               		.stabn	68,0,81,.LM1-.LFBB1
 131               	.LM1:
 132 0010 E091 0000 		lds r30,tx_tail
 133 0014 8091 0000 		lds r24,tx_head
 134 0018 8E13      		cpse r24,r30
 135 001a 00C0      		rjmp .L2
  82:main.c        ****         UCSR0B &= ~(1 << UDRIE0);
 136               		.stabn	68,0,82,.LM2-.LFBB1
 137               	.LM2:
 138 001c 8091 C100 		lds r24,193
 139 0020 8F7D      		andi r24,lo8(-33)
 140 0022 8093 C100 		sts 193,r24
  83:main.c        ****         usart_transmitting = 0;
 141               		.stabn	68,0,83,.LM3-.LFBB1
 142               	.LM3:
 143 0026 1092 0000 		sts usart_transmitting,__zero_reg__
 144               	.L1:
 145               	/* epilogue start */
GAS LISTING /tmp/ccsBKM5i.s 			page 5


  84:main.c        ****     } else {
  85:main.c        ****         UDR0 = tx_buffer[tx_tail];
  86:main.c        ****         if (++tx_tail >= BUFFER_SIZE)
  87:main.c        ****             tx_tail = 0;
  88:main.c        ****     }
  89:main.c        **** }
 146               		.stabn	68,0,89,.LM4-.LFBB1
 147               	.LM4:
 148 002a FF91      		pop r31
 149 002c EF91      		pop r30
 150 002e 8F91      		pop r24
 151 0030 0F90      		pop r0
 152 0032 0FBE      		out __SREG__,r0
 153 0034 0F90      		pop r0
 154 0036 1F90      		pop r1
 155 0038 1895      		reti
 156               	.L2:
  85:main.c        ****         if (++tx_tail >= BUFFER_SIZE)
 157               		.stabn	68,0,85,.LM5-.LFBB1
 158               	.LM5:
 159 003a F0E0      		ldi r31,0
 160 003c E050      		subi r30,lo8(-(tx_buffer))
 161 003e F040      		sbci r31,hi8(-(tx_buffer))
 162 0040 8081      		ld r24,Z
 163 0042 8093 C600 		sts 198,r24
  86:main.c        ****             tx_tail = 0;
 164               		.stabn	68,0,86,.LM6-.LFBB1
 165               	.LM6:
 166 0046 8091 0000 		lds r24,tx_tail
 167 004a 8F5F      		subi r24,lo8(-(1))
 168 004c 8F3F      		cpi r24,lo8(-1)
 169 004e 01F0      		breq .L4
 170 0050 8093 0000 		sts tx_tail,r24
 171 0054 00C0      		rjmp .L1
 172               	.L4:
  87:main.c        ****     }
 173               		.stabn	68,0,87,.LM7-.LFBB1
 174               	.LM7:
 175 0056 1092 0000 		sts tx_tail,__zero_reg__
 176               		.stabn	68,0,89,.LM8-.LFBB1
 177               	.LM8:
 178 005a 00C0      		rjmp .L1
 179               		.size	__vector_19, .-__vector_19
 180               	.Lscope1:
 181               		.stabs	"",36,0,0,.Lscope1-.LFBB1
 182               		.stabd	78,0,0
 183               		.stabs	"read_rx_buffer:F(5,4)",36,0,271,read_rx_buffer
 184               	.global	read_rx_buffer
 185               		.type	read_rx_buffer, @function
 186               	read_rx_buffer:
 187               		.stabd	46,0,0
  90:main.c        **** 
  91:main.c        **** int main(void) {
  92:main.c        ****     /* Fa√ßa a configura√ß√£o do que for necess√°rio aqui */
  93:main.c        ****     /* Seu c√≥digo aqui */
  94:main.c        ****     UCSR0A = (1 << U2X0); /* double speed */
  95:main.c        ****     UCSR0B = (1<<RXEN0) | (1 << TXEN0) | (1 << RXCIE0); /* Enable rx and tx, rx complete interrupt 
GAS LISTING /tmp/ccsBKM5i.s 			page 6


  96:main.c        ****     UCSR0C = (1<<UCSZ01) | (1<<UCSZ00); /* Set frame format: 8N1 */
  97:main.c        ****     UBRR0H = (MYUBRR>>8); /* Set baud rate */
  98:main.c        ****     UBRR0L = MYUBRR; /* Set baud rate */
  99:main.c        **** 
 100:main.c        ****     DDRB |= (1 << PB5); // Configura PB5 como sa√≠da (LED)
 101:main.c        ****     PORTB &= ~(1 << PB5); // Garante que o LED est√° apagado no in√≠cio   
 102:main.c        **** 
 103:main.c        ****     sei();
 104:main.c        **** 
 105:main.c        ****     /* Implemente os testes aqui. Veja o texto para os detalhes */
 106:main.c        ****     
 107:main.c        ****     /* Teste 2 */
 108:main.c        ****     uint8_t str_test[] = "Universidade Federal de Pernambuco\nDepartamento de Eletr√¥nica e Sistema
 109:main.c        ****     write(str_test, sizeof(str_test)-1, 1);
 110:main.c        **** 
 111:main.c        ****     delay_ms(1000); /* Delay necess√°rio para o c√≥digo de teste */
 112:main.c        **** 
 113:main.c        ****     /* Teste 3*/
 114:main.c        ****     uint8_t i = sizeof(str_test);
 115:main.c        ****     uint8_t j = 0;
 116:main.c        ****     while (i) {
 117:main.c        ****         if (i >= 10) {
 118:main.c        ****             i -= write(str_test+j, 10, 0);
 119:main.c        ****             j += 10;
 120:main.c        ****         } else {
 121:main.c        ****             write(str_test+j, i-1, 1);
 122:main.c        ****             i = 0;
 123:main.c        ****         }
 124:main.c        ****     }
 125:main.c        **** 
 126:main.c        ****     /* Teste 4 */
 127:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 128:main.c        ****     uint16_t nbytes = 0;
 129:main.c        ****     uint8_t buffer[255];
 130:main.c        ****     while (nbytes < 300) {
 131:main.c        ****         nbytes += read(buffer, 300-nbytes > 254 ? 254 : 300-nbytes) - 1; /* Conferir se precisa des
 132:main.c        ****     }
 133:main.c        ****     flow_off();
 134:main.c        ****     if (received_data()) {
 135:main.c        ****         turn_led_on();
 136:main.c        ****     } else {
 137:main.c        ****         blink_led();
 138:main.c        ****     }
 139:main.c        **** 
 140:main.c        ****     /* Teste 5 */
 141:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 142:main.c        ****     flow_on(); /* Precisa do flow_on()? */
 143:main.c        ****     PORTB &= ~(1 << PB5); /* Apaga o LED */
 144:main.c        ****     nbytes = 0;
 145:main.c        ****     while (nbytes < 300) {
 146:main.c        ****         nbytes += read(buffer, 300-nbytes > 254 ? 254 : 300-nbytes) - 1; /* Conferir se precisa des
 147:main.c        ****     }
 148:main.c        **** 
 149:main.c        ****     flow_off();
 150:main.c        ****     if (received_data()) {
 151:main.c        ****         turn_led_on();
 152:main.c        ****     } else {
GAS LISTING /tmp/ccsBKM5i.s 			page 7


 153:main.c        ****         blink_led();
 154:main.c        ****     }
 155:main.c        **** 
 156:main.c        ****     /* Teste 6 */
 157:main.c        ****     flow_on(); /* Precisa do flow_on()? */
 158:main.c        ****     PORTB &= ~(1 << PB5); /* Apaga o LED */
 159:main.c        ****     
 160:main.c        ****     uint8_t binary_string[] = {0x00, 0x01, 0x11, 0x02, 0x13, 0x04, 0x7e, 0x05, 0x7d, 0x06};
 161:main.c        ****     i = 0;
 162:main.c        ****     
 163:main.c        ****     /* √â pra ficar reenviando a string ou envia ela apenas uma vez? */
 164:main.c        ****     while (i < sizeof(binary_string)) { 
 165:main.c        ****         if (!write(binary_string+i, 1, 0)) {
 166:main.c        ****             PORTB |= (1 << PB5); /* Acende o LED */
 167:main.c        ****         } else {
 168:main.c        ****             PORTB &= ~(1 << PB5); /* Apaga o LED */
 169:main.c        ****             i++;
 170:main.c        ****         }
 171:main.c        ****     }
 172:main.c        ****     
 173:main.c        ****     /* Teste 7 */
 174:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 175:main.c        ****     uint8_t comp_str[] = "Desenvolvimento de sistemas embarcados";
 176:main.c        ****     uint8_t comp_buffer[sizeof(comp_str)];
 177:main.c        ****     uint8_t k = 0;
 178:main.c        ****     /* Loop infinito necess√°rio em qualquer programa para
 179:main.c        ****        embarcados */
 180:main.c        ****     while (1) {
 181:main.c        ****         /* Letra a */
 182:main.c        ****         read(comp_buffer, 254);
 183:main.c        **** 
 184:main.c        ****         /*
 185:main.c        ****         for (int z = 0; z < strlen((const char *)comp_buffer); z++){
 186:main.c        ****             write_tx_buffer(comp_buffer[z]);
 187:main.c        ****         }
 188:main.c        ****         write_tx_buffer('\n');
 189:main.c        ****         */
 190:main.c        ****         
 191:main.c        ****         if (memcmp(comp_buffer, comp_str, strlen((const char *)comp_str)+1) == 0) {
 192:main.c        ****             PORTB |= (1 << PB5);
 193:main.c        ****         } else {
 194:main.c        ****             PORTB &= ~(1 << PB5);
 195:main.c        ****         }
 196:main.c        **** 
 197:main.c        ****         /* Letra b */
 198:main.c        ****         k = 0;
 199:main.c        ****         while (read(comp_buffer+k, 10) == 11) {
 200:main.c        ****             k += 10;
 201:main.c        ****         };
 202:main.c        ****         
 203:main.c        ****         /*
 204:main.c        ****         for (int z = 0; z < strlen((const char *)comp_buffer); z++){
 205:main.c        ****             write_tx_buffer(comp_buffer[z]);
 206:main.c        ****         }
 207:main.c        ****         write_tx_buffer('\n');
 208:main.c        ****         */
 209:main.c        **** 
GAS LISTING /tmp/ccsBKM5i.s 			page 8


 210:main.c        ****         if (memcmp(comp_buffer, comp_str, strlen((const char *)comp_str)+1) == 0) {
 211:main.c        ****             PORTB |= (1 << PB5);
 212:main.c        ****         } else {
 213:main.c        ****             PORTB &= ~(1 << PB5);
 214:main.c        ****         }
 215:main.c        ****     }
 216:main.c        **** 
 217:main.c        ****     return 0;
 218:main.c        **** }
 219:main.c        **** 
 220:main.c        **** /* Fun√ß√µes */
 221:main.c        **** 
 222:main.c        **** uint8_t write(uint8_t* buf, uint8_t n, int8_t close_packet){
 223:main.c        ****     tx_byte_cnt = 0;
 224:main.c        **** 
 225:main.c        ****     if (!tx_state) {
 226:main.c        ****         return 0;
 227:main.c        ****     }
 228:main.c        ****     
 229:main.c        ****     while ((tx_byte_cnt < n) && tx_state) {
 230:main.c        ****         if (buf[tx_byte_cnt] == SINC || buf[tx_byte_cnt] == XON || buf[tx_byte_cnt] == XOFF || buf[
 231:main.c        ****             write_tx_buffer(ESC);
 232:main.c        ****         }
 233:main.c        ****         write_tx_buffer(buf[tx_byte_cnt]);
 234:main.c        ****         tx_byte_cnt++;
 235:main.c        ****     }
 236:main.c        **** 
 237:main.c        ****     if (close_packet && tx_state) {
 238:main.c        ****         write_tx_buffer(SINC);
 239:main.c        ****     }
 240:main.c        **** 
 241:main.c        ****     return tx_byte_cnt;
 242:main.c        **** }
 243:main.c        **** 
 244:main.c        **** /* Falta limitar o byte_cnt caso ultrapasse o tamanho do buffer */
 245:main.c        **** uint8_t read(uint8_t* buf, uint8_t n) {
 246:main.c        ****     uint8_t received_byte, byte_cnt = 0;
 247:main.c        **** 
 248:main.c        ****     while (byte_cnt < n) { 
 249:main.c        ****         if (!rx_state) {
 250:main.c        ****             return 0;
 251:main.c        ****         }
 252:main.c        ****         while (!rcvd_byte);
 253:main.c        **** 
 254:main.c        ****         received_byte = read_rx_buffer();
 255:main.c        **** 
 256:main.c        ****         if (rx_sinc) {
 257:main.c        ****             buf[byte_cnt] = '\0';
 258:main.c        ****             rx_sinc = 0;
 259:main.c        ****             rcvd_byte = 0;
 260:main.c        ****             return byte_cnt;
 261:main.c        ****         }
 262:main.c        **** 
 263:main.c        ****         buf[byte_cnt] = received_byte;
 264:main.c        ****         byte_cnt++;
 265:main.c        **** 
 266:main.c        ****         rcvd_byte = 0;
GAS LISTING /tmp/ccsBKM5i.s 			page 9


 267:main.c        ****     }
 268:main.c        ****     return n+1;
 269:main.c        **** }
 270:main.c        **** 
 271:main.c        **** uint16_t read_rx_buffer(void)
 272:main.c        **** {
 188               		.stabn	68,0,272,.LM9-.LFBB2
 189               	.LM9:
 190               	.LFBB2:
 191               	/* prologue: function */
 192               	/* frame size = 0 */
 193               	/* stack size = 0 */
 194               	.L__stack_usage = 0
 273:main.c        ****     uint8_t rc = 0, c = 0;
 274:main.c        **** 
 275:main.c        ****     cli();
 195               		.stabn	68,0,275,.LM10-.LFBB2
 196               	.LM10:
 197               	/* #APP */
 198               	 ;  275 "main.c" 1
 199 005c F894      		cli
 200               	 ;  0 "" 2
 276:main.c        ****     if (rx_head != rx_tail) {
 201               		.stabn	68,0,276,.LM11-.LFBB2
 202               	.LM11:
 203               	/* #NOAPP */
 204 005e 9091 0000 		lds r25,rx_tail
 205 0062 8091 0000 		lds r24,rx_head
 206 0066 8917      		cp r24,r25
 207 0068 01F0      		breq .L8
 277:main.c        ****         c = rx_buffer[rx_tail];
 208               		.stabn	68,0,277,.LM12-.LFBB2
 209               	.LM12:
 210 006a E92F      		mov r30,r25
 211 006c F0E0      		ldi r31,0
 212 006e E050      		subi r30,lo8(-(rx_buffer))
 213 0070 F040      		sbci r31,hi8(-(rx_buffer))
 214 0072 8081      		ld r24,Z
 278:main.c        ****         if (++rx_tail >= BUFFER_SIZE)
 215               		.stabn	68,0,278,.LM13-.LFBB2
 216               	.LM13:
 217 0074 9F5F      		subi r25,lo8(-(1))
 218 0076 9F3F      		cpi r25,lo8(-1)
 219 0078 01F0      		breq .L7
 220 007a 9093 0000 		sts rx_tail,r25
 221               	.L9:
 273:main.c        **** 
 222               		.stabn	68,0,273,.LM14-.LFBB2
 223               	.LM14:
 224 007e 20E0      		ldi r18,0
 225               	.L6:
 279:main.c        ****             rx_tail = 0;
 280:main.c        ****     } else 
 281:main.c        ****         rc = 1;
 282:main.c        ****     sei();
 226               		.stabn	68,0,282,.LM15-.LFBB2
 227               	.LM15:
GAS LISTING /tmp/ccsBKM5i.s 			page 10


 228               	/* #APP */
 229               	 ;  282 "main.c" 1
 230 0080 7894      		sei
 231               	 ;  0 "" 2
 283:main.c        ****     return ((uint16_t) rc << 8) | c;
 284:main.c        **** }
 232               		.stabn	68,0,284,.LM16-.LFBB2
 233               	.LM16:
 234               	/* #NOAPP */
 235 0082 922F      		mov r25,r18
 236               	/* epilogue start */
 237 0084 0895      		ret
 238               	.L7:
 279:main.c        ****             rx_tail = 0;
 239               		.stabn	68,0,279,.LM17-.LFBB2
 240               	.LM17:
 241 0086 1092 0000 		sts rx_tail,__zero_reg__
 242 008a 00C0      		rjmp .L9
 243               	.L8:
 273:main.c        **** 
 244               		.stabn	68,0,273,.LM18-.LFBB2
 245               	.LM18:
 246 008c 80E0      		ldi r24,0
 281:main.c        ****     sei();
 247               		.stabn	68,0,281,.LM19-.LFBB2
 248               	.LM19:
 249 008e 21E0      		ldi r18,lo8(1)
 250 0090 00C0      		rjmp .L6
 251               		.size	read_rx_buffer, .-read_rx_buffer
 252               		.stabs	"rc:r(5,2)",64,0,273,18
 253               		.stabs	"c:r(5,2)",64,0,273,24
 254               		.stabn	192,0,0,.LFBB2-.LFBB2
 255               		.stabn	224,0,0,.Lscope2-.LFBB2
 256               	.Lscope2:
 257               		.stabs	"",36,0,0,.Lscope2-.LFBB2
 258               		.stabd	78,0,0
 259               		.stabs	"read:F(5,2)",36,0,245,read
 260               		.stabs	"buf:P(0,51)=*(5,2)",64,0,245,24
 261               		.stabs	"n:P(5,2)",64,0,245,29
 262               	.global	read
 263               		.type	read, @function
 264               	read:
 265               		.stabd	46,0,0
 245:main.c        ****     uint8_t received_byte, byte_cnt = 0;
 266               		.stabn	68,0,245,.LM20-.LFBB3
 267               	.LM20:
 268               	.LFBB3:
 269 0092 0F93      		push r16
 270 0094 1F93      		push r17
 271 0096 CF93      		push r28
 272 0098 DF93      		push r29
 273               	/* prologue: function */
 274               	/* frame size = 0 */
 275               	/* stack size = 4 */
 276               	.L__stack_usage = 4
 277 009a D62F      		mov r29,r22
 278 009c 8C01      		movw r16,r24
GAS LISTING /tmp/ccsBKM5i.s 			page 11


 246:main.c        **** 
 279               		.stabn	68,0,246,.LM21-.LFBB3
 280               	.LM21:
 281 009e C0E0      		ldi r28,0
 282               	.L11:
 248:main.c        ****         if (!rx_state) {
 283               		.stabn	68,0,248,.LM22-.LFBB3
 284               	.LM22:
 285 00a0 CD13      		cpse r28,r29
 286 00a2 00C0      		rjmp .L15
 268:main.c        **** }
 287               		.stabn	68,0,268,.LM23-.LFBB3
 288               	.LM23:
 289 00a4 81E0      		ldi r24,lo8(1)
 290 00a6 8C0F      		add r24,r28
 291 00a8 00C0      		rjmp .L10
 292               	.L15:
 249:main.c        ****             return 0;
 293               		.stabn	68,0,249,.LM24-.LFBB3
 294               	.LM24:
 295 00aa 8091 0000 		lds r24,rx_state
 296 00ae 8823      		tst r24
 297 00b0 01F0      		breq .L10
 298               	.L13:
 252:main.c        **** 
 299               		.stabn	68,0,252,.LM25-.LFBB3
 300               	.LM25:
 301 00b2 8091 0000 		lds r24,rcvd_byte
 302 00b6 8823      		tst r24
 303 00b8 01F0      		breq .L13
 254:main.c        **** 
 304               		.stabn	68,0,254,.LM26-.LFBB3
 305               	.LM26:
 306 00ba 0E94 0000 		call read_rx_buffer
 256:main.c        ****             buf[byte_cnt] = '\0';
 307               		.stabn	68,0,256,.LM27-.LFBB3
 308               	.LM27:
 309 00be 9091 0000 		lds r25,rx_sinc
 257:main.c        ****             rx_sinc = 0;
 310               		.stabn	68,0,257,.LM28-.LFBB3
 311               	.LM28:
 312 00c2 F801      		movw r30,r16
 256:main.c        ****             buf[byte_cnt] = '\0';
 313               		.stabn	68,0,256,.LM29-.LFBB3
 314               	.LM29:
 315 00c4 9923      		tst r25
 316 00c6 01F0      		breq .L14
 257:main.c        ****             rx_sinc = 0;
 317               		.stabn	68,0,257,.LM30-.LFBB3
 318               	.LM30:
 319 00c8 1082      		st Z,__zero_reg__
 258:main.c        ****             rcvd_byte = 0;
 320               		.stabn	68,0,258,.LM31-.LFBB3
 321               	.LM31:
 322 00ca 1092 0000 		sts rx_sinc,__zero_reg__
 259:main.c        ****             return byte_cnt;
 323               		.stabn	68,0,259,.LM32-.LFBB3
GAS LISTING /tmp/ccsBKM5i.s 			page 12


 324               	.LM32:
 325 00ce 1092 0000 		sts rcvd_byte,__zero_reg__
 260:main.c        ****         }
 326               		.stabn	68,0,260,.LM33-.LFBB3
 327               	.LM33:
 328 00d2 8C2F      		mov r24,r28
 329               	.L10:
 330               	/* epilogue start */
 269:main.c        **** 
 331               		.stabn	68,0,269,.LM34-.LFBB3
 332               	.LM34:
 333 00d4 DF91      		pop r29
 334 00d6 CF91      		pop r28
 335 00d8 1F91      		pop r17
 336 00da 0F91      		pop r16
 337 00dc 0895      		ret
 338               	.L14:
 263:main.c        ****         byte_cnt++;
 339               		.stabn	68,0,263,.LM35-.LFBB3
 340               	.LM35:
 341 00de 8193      		st Z+,r24
 342 00e0 8F01      		movw r16,r30
 264:main.c        **** 
 343               		.stabn	68,0,264,.LM36-.LFBB3
 344               	.LM36:
 345 00e2 CF5F      		subi r28,lo8(-(1))
 266:main.c        ****     }
 346               		.stabn	68,0,266,.LM37-.LFBB3
 347               	.LM37:
 348 00e4 1092 0000 		sts rcvd_byte,__zero_reg__
 349 00e8 00C0      		rjmp .L11
 350               		.size	read, .-read
 351               		.stabs	"byte_cnt:r(5,2)",64,0,246,28
 352               		.stabn	192,0,0,.LFBB3-.LFBB3
 353               		.stabn	224,0,0,.Lscope3-.LFBB3
 354               	.Lscope3:
 355               		.stabs	"",36,0,0,.Lscope3-.LFBB3
 356               		.stabd	78,0,0
 357               		.stabs	"write_tx_buffer:F(5,2)",36,0,286,write_tx_buffer
 358               		.stabs	"c:P(5,2)",64,0,286,18
 359               	.global	write_tx_buffer
 360               		.type	write_tx_buffer, @function
 361               	write_tx_buffer:
 362               		.stabd	46,0,0
 285:main.c        **** 
 286:main.c        **** uint8_t write_tx_buffer(uint8_t c) {
 363               		.stabn	68,0,286,.LM38-.LFBB4
 364               	.LM38:
 365               	.LFBB4:
 366               	/* prologue: function */
 367               	/* frame size = 0 */
 368               	/* stack size = 0 */
 369               	.L__stack_usage = 0
 370 00ea 282F      		mov r18,r24
 287:main.c        ****     uint8_t rc = 0;
 288:main.c        **** 
 289:main.c        ****     cli();
GAS LISTING /tmp/ccsBKM5i.s 			page 13


 371               		.stabn	68,0,289,.LM39-.LFBB4
 372               	.LM39:
 373               	/* #APP */
 374               	 ;  289 "main.c" 1
 375 00ec F894      		cli
 376               	 ;  0 "" 2
 290:main.c        **** 
 291:main.c        ****     if(!usart_transmitting){
 377               		.stabn	68,0,291,.LM40-.LFBB4
 378               	.LM40:
 379               	/* #NOAPP */
 380 00ee 8091 0000 		lds r24,usart_transmitting
 381 00f2 8111      		cpse r24,__zero_reg__
 382 00f4 00C0      		rjmp .L22
 292:main.c        ****         UDR0 = c;
 383               		.stabn	68,0,292,.LM41-.LFBB4
 384               	.LM41:
 385 00f6 2093 C600 		sts 198,r18
 293:main.c        ****         UCSR0B |= (1 << UDRIE0);
 386               		.stabn	68,0,293,.LM42-.LFBB4
 387               	.LM42:
 388 00fa 9091 C100 		lds r25,193
 389 00fe 9062      		ori r25,lo8(32)
 390 0100 9093 C100 		sts 193,r25
 294:main.c        ****         usart_transmitting = 1;
 391               		.stabn	68,0,294,.LM43-.LFBB4
 392               	.LM43:
 393 0104 91E0      		ldi r25,lo8(1)
 394 0106 9093 0000 		sts usart_transmitting,r25
 395               	.L23:
 295:main.c        ****     } else{
 296:main.c        ****         uint8_t next = tx_head + 1;
 297:main.c        ****         if (next >= BUFFER_SIZE)
 298:main.c        ****             next = 0;
 299:main.c        ****         if (next != tx_tail) {
 300:main.c        ****             tx_buffer[tx_head] = c;
 301:main.c        ****             tx_head = next;
 302:main.c        ****         } else  /* buffer cheio */
 303:main.c        ****             rc = 1;
 304:main.c        ****     }
 305:main.c        ****     sei();
 396               		.stabn	68,0,305,.LM44-.LFBB4
 397               	.LM44:
 398               	/* #APP */
 399               	 ;  305 "main.c" 1
 400 010a 7894      		sei
 401               	 ;  0 "" 2
 402               	/* epilogue start */
 306:main.c        ****     return rc;
 307:main.c        **** }
 403               		.stabn	68,0,307,.LM45-.LFBB4
 404               	.LM45:
 405               	/* #NOAPP */
 406 010c 0895      		ret
 407               	.L22:
 408               	.LBB2:
 296:main.c        ****         if (next >= BUFFER_SIZE)
GAS LISTING /tmp/ccsBKM5i.s 			page 14


 409               		.stabn	68,0,296,.LM46-.LFBB4
 410               	.LM46:
 411 010e E091 0000 		lds r30,tx_head
 412 0112 91E0      		ldi r25,lo8(1)
 413 0114 9E0F      		add r25,r30
 297:main.c        ****             next = 0;
 414               		.stabn	68,0,297,.LM47-.LFBB4
 415               	.LM47:
 416 0116 9F3F      		cpi r25,lo8(-1)
 417 0118 01F4      		brne .L24
 298:main.c        ****         if (next != tx_tail) {
 418               		.stabn	68,0,298,.LM48-.LFBB4
 419               	.LM48:
 420 011a 90E0      		ldi r25,0
 421               	.L24:
 299:main.c        ****             tx_buffer[tx_head] = c;
 422               		.stabn	68,0,299,.LM49-.LFBB4
 423               	.LM49:
 424 011c 8091 0000 		lds r24,tx_tail
 425 0120 8917      		cp r24,r25
 426 0122 01F0      		breq .L25
 300:main.c        ****             tx_head = next;
 427               		.stabn	68,0,300,.LM50-.LFBB4
 428               	.LM50:
 429 0124 F0E0      		ldi r31,0
 430 0126 E050      		subi r30,lo8(-(tx_buffer))
 431 0128 F040      		sbci r31,hi8(-(tx_buffer))
 432 012a 2083      		st Z,r18
 301:main.c        ****         } else  /* buffer cheio */
 433               		.stabn	68,0,301,.LM51-.LFBB4
 434               	.LM51:
 435 012c 9093 0000 		sts tx_head,r25
 436               	.LBE2:
 287:main.c        **** 
 437               		.stabn	68,0,287,.LM52-.LFBB4
 438               	.LM52:
 439 0130 80E0      		ldi r24,0
 440               	.LBB3:
 441 0132 00C0      		rjmp .L23
 442               	.L25:
 303:main.c        ****     }
 443               		.stabn	68,0,303,.LM53-.LFBB4
 444               	.LM53:
 445 0134 81E0      		ldi r24,lo8(1)
 446 0136 00C0      		rjmp .L23
 447               	.LBE3:
 448               		.size	write_tx_buffer, .-write_tx_buffer
 449               		.stabs	"rc:r(5,2)",64,0,287,24
 450               		.stabn	192,0,0,.LFBB4-.LFBB4
 451               		.stabs	"next:r(5,2)",64,0,296,25
 452               		.stabn	192,0,0,.LBB2-.LFBB4
 453               		.stabn	224,0,0,.LBE2-.LFBB4
 454               		.stabs	"next:r(5,2)",64,0,296,25
 455               		.stabn	192,0,0,.LBB3-.LFBB4
 456               		.stabn	224,0,0,.LBE3-.LFBB4
 457               		.stabn	224,0,0,.Lscope4-.LFBB4
 458               	.Lscope4:
GAS LISTING /tmp/ccsBKM5i.s 			page 15


 459               		.stabs	"",36,0,0,.Lscope4-.LFBB4
 460               		.stabd	78,0,0
 461               		.stabs	"write:F(5,2)",36,0,222,write
 462               		.stabs	"buf:P(0,51)",64,0,222,28
 463               		.stabs	"n:P(5,2)",64,0,222,16
 464               		.stabs	"close_packet:P(5,1)",64,0,222,17
 465               	.global	write
 466               		.type	write, @function
 467               	write:
 468               		.stabd	46,0,0
 222:main.c        ****     tx_byte_cnt = 0;
 469               		.stabn	68,0,222,.LM54-.LFBB5
 470               	.LM54:
 471               	.LFBB5:
 472 0138 0F93      		push r16
 473 013a 1F93      		push r17
 474 013c CF93      		push r28
 475 013e DF93      		push r29
 476               	/* prologue: function */
 477               	/* frame size = 0 */
 478               	/* stack size = 4 */
 479               	.L__stack_usage = 4
 480 0140 EC01      		movw r28,r24
 481 0142 062F      		mov r16,r22
 482 0144 142F      		mov r17,r20
 223:main.c        **** 
 483               		.stabn	68,0,223,.LM55-.LFBB5
 484               	.LM55:
 485 0146 1092 0000 		sts tx_byte_cnt,__zero_reg__
 225:main.c        ****         return 0;
 486               		.stabn	68,0,225,.LM56-.LFBB5
 487               	.LM56:
 488 014a 8091 0000 		lds r24,tx_state
 489 014e 8111      		cpse r24,__zero_reg__
 490 0150 00C0      		rjmp .L28
 491               	.L26:
 492               	/* epilogue start */
 242:main.c        **** 
 493               		.stabn	68,0,242,.LM57-.LFBB5
 494               	.LM57:
 495 0152 DF91      		pop r29
 496 0154 CF91      		pop r28
 497 0156 1F91      		pop r17
 498 0158 0F91      		pop r16
 499 015a 0895      		ret
 500               	.L32:
 501               	.LBB6:
 502               	.LBB7:
 230:main.c        ****             write_tx_buffer(ESC);
 503               		.stabn	68,0,230,.LM58-.LFBB5
 504               	.LM58:
 505 015c EC0F      		add r30,r28
 506 015e FD2F      		mov r31,r29
 507 0160 F11D      		adc r31,__zero_reg__
 508 0162 8081      		ld r24,Z
 509 0164 982F      		mov r25,r24
 510 0166 9D7F      		andi r25,lo8(-3)
GAS LISTING /tmp/ccsBKM5i.s 			page 16


 511 0168 9131      		cpi r25,lo8(17)
 512 016a 01F0      		breq .L29
 513 016c 8D57      		subi r24,lo8(-(-125))
 514 016e 8230      		cpi r24,lo8(2)
 515 0170 00F4      		brsh .L30
 516               	.L29:
 231:main.c        ****         }
 517               		.stabn	68,0,231,.LM59-.LFBB5
 518               	.LM59:
 519 0172 8DE7      		ldi r24,lo8(125)
 520 0174 0E94 0000 		call write_tx_buffer
 521               	.L30:
 233:main.c        ****         tx_byte_cnt++;
 522               		.stabn	68,0,233,.LM60-.LFBB5
 523               	.LM60:
 524 0178 E091 0000 		lds r30,tx_byte_cnt
 525 017c EC0F      		add r30,r28
 526 017e FD2F      		mov r31,r29
 527 0180 F11D      		adc r31,__zero_reg__
 528 0182 8081      		ld r24,Z
 529 0184 0E94 0000 		call write_tx_buffer
 234:main.c        ****     }
 530               		.stabn	68,0,234,.LM61-.LFBB5
 531               	.LM61:
 532 0188 8091 0000 		lds r24,tx_byte_cnt
 533 018c 8F5F      		subi r24,lo8(-(1))
 534 018e 8093 0000 		sts tx_byte_cnt,r24
 535               	.L28:
 229:main.c        ****         if (buf[tx_byte_cnt] == SINC || buf[tx_byte_cnt] == XON || buf[tx_byte_cnt] == XOFF || buf[
 536               		.stabn	68,0,229,.LM62-.LFBB5
 537               	.LM62:
 538 0192 E091 0000 		lds r30,tx_byte_cnt
 539 0196 E017      		cp r30,r16
 540 0198 00F4      		brsh .L31
 541 019a 8091 0000 		lds r24,tx_state
 542 019e 8111      		cpse r24,__zero_reg__
 543 01a0 00C0      		rjmp .L32
 544               	.L33:
 241:main.c        **** }
 545               		.stabn	68,0,241,.LM63-.LFBB5
 546               	.LM63:
 547 01a2 8091 0000 		lds r24,tx_byte_cnt
 548 01a6 00C0      		rjmp .L26
 549               	.L31:
 237:main.c        ****         write_tx_buffer(SINC);
 550               		.stabn	68,0,237,.LM64-.LFBB5
 551               	.LM64:
 552 01a8 1123      		tst r17
 553 01aa 01F0      		breq .L33
 554 01ac 8091 0000 		lds r24,tx_state
 555 01b0 8823      		tst r24
 556 01b2 01F0      		breq .L33
 238:main.c        ****     }
 557               		.stabn	68,0,238,.LM65-.LFBB5
 558               	.LM65:
 559 01b4 8EE7      		ldi r24,lo8(126)
 560 01b6 0E94 0000 		call write_tx_buffer
GAS LISTING /tmp/ccsBKM5i.s 			page 17


 561 01ba 00C0      		rjmp .L33
 562               	.LBE7:
 563               	.LBE6:
 564               		.size	write, .-write
 565               	.Lscope5:
 566               		.stabs	"",36,0,0,.Lscope5-.LFBB5
 567               		.stabd	78,0,0
 568               		.stabs	"enqueue_rx_buffer:F(0,50)",36,0,309,enqueue_rx_buffer
 569               		.stabs	"received_data:P(5,2)",64,0,309,24
 570               	.global	enqueue_rx_buffer
 571               		.type	enqueue_rx_buffer, @function
 572               	enqueue_rx_buffer:
 573               		.stabd	46,0,0
 308:main.c        **** 
 309:main.c        **** void enqueue_rx_buffer(uint8_t received_data) {
 574               		.stabn	68,0,309,.LM66-.LFBB6
 575               	.LM66:
 576               	.LFBB6:
 577               	/* prologue: function */
 578               	/* frame size = 0 */
 579               	/* stack size = 0 */
 580               	.L__stack_usage = 0
 310:main.c        ****     uint8_t next = rx_head + 1;
 581               		.stabn	68,0,310,.LM67-.LFBB6
 582               	.LM67:
 583 01bc E091 0000 		lds r30,rx_head
 584 01c0 91E0      		ldi r25,lo8(1)
 585 01c2 9E0F      		add r25,r30
 311:main.c        ****         if (next >= BUFFER_SIZE)
 586               		.stabn	68,0,311,.LM68-.LFBB6
 587               	.LM68:
 588 01c4 9F3F      		cpi r25,lo8(-1)
 589 01c6 01F4      		brne .L47
 312:main.c        ****             next = 0;
 590               		.stabn	68,0,312,.LM69-.LFBB6
 591               	.LM69:
 592 01c8 90E0      		ldi r25,0
 593               	.L47:
 313:main.c        ****         
 314:main.c        ****         /* Se o buffer estiver cheio desprezamos o byte recebido mais antigo e
 315:main.c        ****         * colocamos o byte que acabamos de receber em seu lugar */
 316:main.c        ****         rx_buffer[rx_head] = received_data;
 594               		.stabn	68,0,316,.LM70-.LFBB6
 595               	.LM70:
 596 01ca F0E0      		ldi r31,0
 597 01cc E050      		subi r30,lo8(-(rx_buffer))
 598 01ce F040      		sbci r31,hi8(-(rx_buffer))
 599 01d0 8083      		st Z,r24
 317:main.c        ****         rx_head = next;
 600               		.stabn	68,0,317,.LM71-.LFBB6
 601               	.LM71:
 602 01d2 9093 0000 		sts rx_head,r25
 318:main.c        ****         if (next == rx_tail) { /* buffer cheio */
 603               		.stabn	68,0,318,.LM72-.LFBB6
 604               	.LM72:
 605 01d6 8091 0000 		lds r24,rx_tail
 606 01da 8913      		cpse r24,r25
GAS LISTING /tmp/ccsBKM5i.s 			page 18


 607 01dc 00C0      		rjmp .L49
 319:main.c        ****             rx_tail++;
 608               		.stabn	68,0,319,.LM73-.LFBB6
 609               	.LM73:
 610 01de 9F5F      		subi r25,lo8(-(1))
 320:main.c        ****             if (rx_tail >= BUFFER_SIZE)
 611               		.stabn	68,0,320,.LM74-.LFBB6
 612               	.LM74:
 613 01e0 9F3F      		cpi r25,lo8(-1)
 614 01e2 01F0      		breq .L50
 319:main.c        ****             rx_tail++;
 615               		.stabn	68,0,319,.LM75-.LFBB6
 616               	.LM75:
 617 01e4 9093 0000 		sts rx_tail,r25
 618               	.L49:
 321:main.c        ****                 rx_tail = 0;
 322:main.c        ****         }
 323:main.c        ****         rcvd_byte = 1;
 619               		.stabn	68,0,323,.LM76-.LFBB6
 620               	.LM76:
 621 01e8 81E0      		ldi r24,lo8(1)
 622 01ea 8093 0000 		sts rcvd_byte,r24
 623               	/* epilogue start */
 324:main.c        **** }
 624               		.stabn	68,0,324,.LM77-.LFBB6
 625               	.LM77:
 626 01ee 0895      		ret
 627               	.L50:
 321:main.c        ****                 rx_tail = 0;
 628               		.stabn	68,0,321,.LM78-.LFBB6
 629               	.LM78:
 630 01f0 1092 0000 		sts rx_tail,__zero_reg__
 631 01f4 00C0      		rjmp .L49
 632               		.size	enqueue_rx_buffer, .-enqueue_rx_buffer
 633               		.stabs	"next:r(5,2)",64,0,310,25
 634               		.stabn	192,0,0,.LFBB6-.LFBB6
 635               		.stabn	224,0,0,.Lscope6-.LFBB6
 636               	.Lscope6:
 637               		.stabs	"",36,0,0,.Lscope6-.LFBB6
 638               		.stabd	78,0,0
 639               		.stabs	"__vector_18:F(0,50)",36,0,52,__vector_18
 640               	.global	__vector_18
 641               		.type	__vector_18, @function
 642               	__vector_18:
 643               		.stabd	46,0,0
  52:main.c        ****     uint8_t received_data = UDR0;
 644               		.stabn	68,0,52,.LM79-.LFBB7
 645               	.LM79:
 646               	.LFBB7:
 647 01f6 1F92      		push r1
 648 01f8 0F92      		push r0
 649 01fa 0FB6      		in r0,__SREG__
 650 01fc 0F92      		push r0
 651 01fe 1124      		clr __zero_reg__
 652 0200 2F93      		push r18
 653 0202 3F93      		push r19
 654 0204 4F93      		push r20
GAS LISTING /tmp/ccsBKM5i.s 			page 19


 655 0206 5F93      		push r21
 656 0208 6F93      		push r22
 657 020a 7F93      		push r23
 658 020c 8F93      		push r24
 659 020e 9F93      		push r25
 660 0210 AF93      		push r26
 661 0212 BF93      		push r27
 662 0214 EF93      		push r30
 663 0216 FF93      		push r31
 664               	/* prologue: Signal */
 665               	/* frame size = 0 */
 666               	/* stack size = 15 */
 667               	.L__stack_usage = 15
  53:main.c        ****     
 668               		.stabn	68,0,53,.LM80-.LFBB7
 669               	.LM80:
 670 0218 8091 C600 		lds r24,198
  55:main.c        ****         if (received_data == ESC) {
 671               		.stabn	68,0,55,.LM81-.LFBB7
 672               	.LM81:
 673 021c 9091 0000 		lds r25,rx_esc
 674 0220 9111      		cpse r25,__zero_reg__
 675 0222 00C0      		rjmp .L53
  56:main.c        ****             rx_esc = 1;
 676               		.stabn	68,0,56,.LM82-.LFBB7
 677               	.LM82:
 678 0224 8D37      		cpi r24,lo8(125)
 679 0226 01F4      		brne .L54
  57:main.c        ****         } else if (received_data == XOFF) {
 680               		.stabn	68,0,57,.LM83-.LFBB7
 681               	.LM83:
 682 0228 81E0      		ldi r24,lo8(1)
 683 022a 8093 0000 		sts rx_esc,r24
 684               	.L52:
 685               	/* epilogue start */
  72:main.c        **** 
 686               		.stabn	68,0,72,.LM84-.LFBB7
 687               	.LM84:
 688 022e FF91      		pop r31
 689 0230 EF91      		pop r30
 690 0232 BF91      		pop r27
 691 0234 AF91      		pop r26
 692 0236 9F91      		pop r25
 693 0238 8F91      		pop r24
 694 023a 7F91      		pop r23
 695 023c 6F91      		pop r22
 696 023e 5F91      		pop r21
 697 0240 4F91      		pop r20
 698 0242 3F91      		pop r19
 699 0244 2F91      		pop r18
 700 0246 0F90      		pop r0
 701 0248 0FBE      		out __SREG__,r0
 702 024a 0F90      		pop r0
 703 024c 1F90      		pop r1
 704 024e 1895      		reti
 705               	.L54:
  58:main.c        ****             tx_state = 0;
GAS LISTING /tmp/ccsBKM5i.s 			page 20


 706               		.stabn	68,0,58,.LM85-.LFBB7
 707               	.LM85:
 708 0250 8331      		cpi r24,lo8(19)
 709 0252 01F4      		brne .L56
  59:main.c        ****         } else if (received_data == XON) {
 710               		.stabn	68,0,59,.LM86-.LFBB7
 711               	.LM86:
 712 0254 1092 0000 		sts tx_state,__zero_reg__
 713 0258 00C0      		rjmp .L52
 714               	.L56:
  60:main.c        ****             tx_state = 1;
 715               		.stabn	68,0,60,.LM87-.LFBB7
 716               	.LM87:
 717 025a 8131      		cpi r24,lo8(17)
 718 025c 01F4      		brne .L57
  61:main.c        ****         } else if (received_data == SINC){
 719               		.stabn	68,0,61,.LM88-.LFBB7
 720               	.LM88:
 721 025e 81E0      		ldi r24,lo8(1)
 722 0260 8093 0000 		sts tx_state,r24
 723 0264 00C0      		rjmp .L52
 724               	.L57:
  62:main.c        ****             rx_sinc = 1;
 725               		.stabn	68,0,62,.LM89-.LFBB7
 726               	.LM89:
 727 0266 8E37      		cpi r24,lo8(126)
 728 0268 01F4      		brne .L58
  63:main.c        ****             rcvd_byte = 1;
 729               		.stabn	68,0,63,.LM90-.LFBB7
 730               	.LM90:
 731 026a 81E0      		ldi r24,lo8(1)
 732 026c 8093 0000 		sts rx_sinc,r24
  64:main.c        ****         } else {
 733               		.stabn	68,0,64,.LM91-.LFBB7
 734               	.LM91:
 735 0270 8093 0000 		sts rcvd_byte,r24
 736 0274 00C0      		rjmp .L52
 737               	.L58:
  66:main.c        ****         }
 738               		.stabn	68,0,66,.LM92-.LFBB7
 739               	.LM92:
 740 0276 0E94 0000 		call enqueue_rx_buffer
 741 027a 00C0      		rjmp .L52
 742               	.L53:
  69:main.c        ****         rx_esc = 0;
 743               		.stabn	68,0,69,.LM93-.LFBB7
 744               	.LM93:
 745 027c 0E94 0000 		call enqueue_rx_buffer
  70:main.c        ****     }
 746               		.stabn	68,0,70,.LM94-.LFBB7
 747               	.LM94:
 748 0280 1092 0000 		sts rx_esc,__zero_reg__
  72:main.c        **** 
 749               		.stabn	68,0,72,.LM95-.LFBB7
 750               	.LM95:
 751 0284 00C0      		rjmp .L52
 752               		.size	__vector_18, .-__vector_18
GAS LISTING /tmp/ccsBKM5i.s 			page 21


 753               		.stabs	"received_data:r(5,2)",64,0,53,24
 754               		.stabn	192,0,0,.LFBB7-.LFBB7
 755               		.stabn	224,0,0,.Lscope7-.LFBB7
 756               	.Lscope7:
 757               		.stabs	"",36,0,0,.Lscope7-.LFBB7
 758               		.stabd	78,0,0
 759               		.stabs	"flow_off:F(0,50)",36,0,326,flow_off
 760               	.global	flow_off
 761               		.type	flow_off, @function
 762               	flow_off:
 763               		.stabd	46,0,0
 325:main.c        **** 
 326:main.c        **** void flow_off(void) {
 764               		.stabn	68,0,326,.LM96-.LFBB8
 765               	.LM96:
 766               	.LFBB8:
 767               	/* prologue: function */
 768               	/* frame size = 0 */
 769               	/* stack size = 0 */
 770               	.L__stack_usage = 0
 327:main.c        ****     write_tx_buffer(XOFF);
 771               		.stabn	68,0,327,.LM97-.LFBB8
 772               	.LM97:
 773 0286 83E1      		ldi r24,lo8(19)
 774 0288 0E94 0000 		call write_tx_buffer
 328:main.c        ****     rx_state = 0;
 775               		.stabn	68,0,328,.LM98-.LFBB8
 776               	.LM98:
 777 028c 1092 0000 		sts rx_state,__zero_reg__
 778               	/* epilogue start */
 329:main.c        **** }
 779               		.stabn	68,0,329,.LM99-.LFBB8
 780               	.LM99:
 781 0290 0895      		ret
 782               		.size	flow_off, .-flow_off
 783               	.Lscope8:
 784               		.stabs	"",36,0,0,.Lscope8-.LFBB8
 785               		.stabd	78,0,0
 786               		.stabs	"flow_on:F(0,50)",36,0,331,flow_on
 787               	.global	flow_on
 788               		.type	flow_on, @function
 789               	flow_on:
 790               		.stabd	46,0,0
 330:main.c        **** 
 331:main.c        **** void flow_on(void) {
 791               		.stabn	68,0,331,.LM100-.LFBB9
 792               	.LM100:
 793               	.LFBB9:
 794               	/* prologue: function */
 795               	/* frame size = 0 */
 796               	/* stack size = 0 */
 797               	.L__stack_usage = 0
 332:main.c        ****     write_tx_buffer(XON);
 798               		.stabn	68,0,332,.LM101-.LFBB9
 799               	.LM101:
 800 0292 81E1      		ldi r24,lo8(17)
 801 0294 0E94 0000 		call write_tx_buffer
GAS LISTING /tmp/ccsBKM5i.s 			page 22


 333:main.c        ****     rx_state = 1;
 802               		.stabn	68,0,333,.LM102-.LFBB9
 803               	.LM102:
 804 0298 81E0      		ldi r24,lo8(1)
 805 029a 8093 0000 		sts rx_state,r24
 806               	/* epilogue start */
 334:main.c        **** }
 807               		.stabn	68,0,334,.LM103-.LFBB9
 808               	.LM103:
 809 029e 0895      		ret
 810               		.size	flow_on, .-flow_on
 811               	.Lscope9:
 812               		.stabs	"",36,0,0,.Lscope9-.LFBB9
 813               		.stabd	78,0,0
 814               		.stabs	"is_flow_on:F(5,2)",36,0,336,is_flow_on
 815               	.global	is_flow_on
 816               		.type	is_flow_on, @function
 817               	is_flow_on:
 818               		.stabd	46,0,0
 335:main.c        **** 
 336:main.c        **** uint8_t is_flow_on(void) {
 819               		.stabn	68,0,336,.LM104-.LFBB10
 820               	.LM104:
 821               	.LFBB10:
 822               	/* prologue: function */
 823               	/* frame size = 0 */
 824               	/* stack size = 0 */
 825               	.L__stack_usage = 0
 337:main.c        ****     return tx_state;
 338:main.c        **** }
 826               		.stabn	68,0,338,.LM105-.LFBB10
 827               	.LM105:
 828 02a0 8091 0000 		lds r24,tx_state
 829               	/* epilogue start */
 830 02a4 0895      		ret
 831               		.size	is_flow_on, .-is_flow_on
 832               	.Lscope10:
 833               		.stabs	"",36,0,0,.Lscope10-.LFBB10
 834               		.stabd	78,0,0
 835               		.stabs	"delay_ms:F(0,50)",36,0,340,delay_ms
 836               		.stabs	"ms:P(5,4)",64,0,340,24
 837               	.global	delay_ms
 838               		.type	delay_ms, @function
 839               	delay_ms:
 840               		.stabd	46,0,0
 339:main.c        **** 
 340:main.c        **** void delay_ms(uint16_t ms)
 341:main.c        **** {
 841               		.stabn	68,0,341,.LM106-.LFBB11
 842               	.LM106:
 843               	.LFBB11:
 844               	/* prologue: function */
 845               	/* frame size = 0 */
 846               	/* stack size = 0 */
 847               	.L__stack_usage = 0
 342:main.c        ****     uint16_t i, j;
 343:main.c        ****     for(i=0; i<ms; i++)
GAS LISTING /tmp/ccsBKM5i.s 			page 23


 848               		.stabn	68,0,343,.LM107-.LFBB11
 849               	.LM107:
 850 02a6 30E0      		ldi r19,0
 851 02a8 20E0      		ldi r18,0
 852               	.L63:
 853               		.stabn	68,0,343,.LM108-.LFBB11
 854               	.LM108:
 855 02aa 2817      		cp r18,r24
 856 02ac 3907      		cpc r19,r25
 857 02ae 01F4      		brne .L65
 858               	/* epilogue start */
 344:main.c        ****         for(j=0; j<4000; j++)
 345:main.c        ****             _NOP();
 346:main.c        **** }
 859               		.stabn	68,0,346,.LM109-.LFBB11
 860               	.LM109:
 861 02b0 0895      		ret
 862               	.L65:
 863 02b2 40EA      		ldi r20,lo8(-96)
 864 02b4 5FE0      		ldi r21,lo8(15)
 865               	.L64:
 345:main.c        **** }
 866               		.stabn	68,0,345,.LM110-.LFBB11
 867               	.LM110:
 868               	/* #APP */
 869               	 ;  345 "main.c" 1
 870 02b6 0000      		nop
 871               	 ;  0 "" 2
 872               	/* #NOAPP */
 873 02b8 4150      		subi r20,1
 874 02ba 5109      		sbc r21,__zero_reg__
 344:main.c        ****         for(j=0; j<4000; j++)
 875               		.stabn	68,0,344,.LM111-.LFBB11
 876               	.LM111:
 877 02bc 01F4      		brne .L64
 343:main.c        ****         for(j=0; j<4000; j++)
 878               		.stabn	68,0,343,.LM112-.LFBB11
 879               	.LM112:
 880 02be 2F5F      		subi r18,-1
 881 02c0 3F4F      		sbci r19,-1
 882 02c2 00C0      		rjmp .L63
 883               		.size	delay_ms, .-delay_ms
 884               		.stabs	"i:r(5,4)",64,0,342,18
 885               		.stabn	192,0,0,.LFBB11-.LFBB11
 886               		.stabn	224,0,0,.Lscope11-.LFBB11
 887               	.Lscope11:
 888               		.stabs	"",36,0,0,.Lscope11-.LFBB11
 889               		.stabd	78,0,0
 890               		.stabs	"blink_led:F(0,50)",36,0,348,blink_led
 891               	.global	blink_led
 892               		.type	blink_led, @function
 893               	blink_led:
 894               		.stabd	46,0,0
 347:main.c        **** 
 348:main.c        **** void blink_led(void) {
 895               		.stabn	68,0,348,.LM113-.LFBB12
 896               	.LM113:
GAS LISTING /tmp/ccsBKM5i.s 			page 24


 897               	.LFBB12:
 898 02c4 CF93      		push r28
 899 02c6 DF93      		push r29
 900               	/* prologue: function */
 901               	/* frame size = 0 */
 902               	/* stack size = 2 */
 903               	.L__stack_usage = 2
 349:main.c        ****     uint8_t k = 5;
 350:main.c        ****     while (k--) {
 904               		.stabn	68,0,350,.LM114-.LFBB12
 905               	.LM114:
 906 02c8 C6E0      		ldi r28,lo8(6)
 351:main.c        ****         PINB = (1 << PB5);
 907               		.stabn	68,0,351,.LM115-.LFBB12
 908               	.LM115:
 909 02ca D0E2      		ldi r29,lo8(32)
 910               	.L68:
 911 02cc C150      		subi r28,lo8(-(-1))
 350:main.c        ****         PINB = (1 << PB5);
 912               		.stabn	68,0,350,.LM116-.LFBB12
 913               	.LM116:
 914 02ce 01F4      		brne .L69
 915               	/* epilogue start */
 352:main.c        ****         delay_ms(1000);
 353:main.c        ****     }
 354:main.c        **** }
 916               		.stabn	68,0,354,.LM117-.LFBB12
 917               	.LM117:
 918 02d0 DF91      		pop r29
 919 02d2 CF91      		pop r28
 920 02d4 0895      		ret
 921               	.L69:
 351:main.c        ****         delay_ms(1000);
 922               		.stabn	68,0,351,.LM118-.LFBB12
 923               	.LM118:
 924 02d6 D3B9      		out 0x3,r29
 352:main.c        ****         delay_ms(1000);
 925               		.stabn	68,0,352,.LM119-.LFBB12
 926               	.LM119:
 927 02d8 88EE      		ldi r24,lo8(-24)
 928 02da 93E0      		ldi r25,lo8(3)
 929 02dc 0E94 0000 		call delay_ms
 930 02e0 00C0      		rjmp .L68
 931               		.size	blink_led, .-blink_led
 932               	.Lscope12:
 933               		.stabs	"",36,0,0,.Lscope12-.LFBB12
 934               		.stabd	78,0,0
 935               		.stabs	"turn_led_on:F(0,50)",36,0,356,turn_led_on
 936               	.global	turn_led_on
 937               		.type	turn_led_on, @function
 938               	turn_led_on:
 939               		.stabd	46,0,0
 355:main.c        **** 
 356:main.c        **** void turn_led_on(void) {
 940               		.stabn	68,0,356,.LM120-.LFBB13
 941               	.LM120:
 942               	.LFBB13:
GAS LISTING /tmp/ccsBKM5i.s 			page 25


 943               	/* prologue: function */
 944               	/* frame size = 0 */
 945               	/* stack size = 0 */
 946               	.L__stack_usage = 0
 357:main.c        ****     PORTB |= (1 << PB5);
 947               		.stabn	68,0,357,.LM121-.LFBB13
 948               	.LM121:
 949 02e2 2D9A      		sbi 0x5,5
 358:main.c        ****     delay_ms(5000);
 950               		.stabn	68,0,358,.LM122-.LFBB13
 951               	.LM122:
 952 02e4 88E8      		ldi r24,lo8(-120)
 953 02e6 93E1      		ldi r25,lo8(19)
 954 02e8 0E94 0000 		call delay_ms
 359:main.c        ****     PORTB &= ~(1 << PB5);
 955               		.stabn	68,0,359,.LM123-.LFBB13
 956               	.LM123:
 957 02ec 2D98      		cbi 0x5,5
 958               	/* epilogue start */
 360:main.c        **** }
 959               		.stabn	68,0,360,.LM124-.LFBB13
 960               	.LM124:
 961 02ee 0895      		ret
 962               		.size	turn_led_on, .-turn_led_on
 963               	.Lscope13:
 964               		.stabs	"",36,0,0,.Lscope13-.LFBB13
 965               		.stabd	78,0,0
 966               		.stabs	"received_data:F(5,2)",36,0,362,received_data
 967               	.global	received_data
 968               		.type	received_data, @function
 969               	received_data:
 970               		.stabd	46,0,0
 361:main.c        **** 
 362:main.c        **** uint8_t received_data(void) {
 971               		.stabn	68,0,362,.LM125-.LFBB14
 972               	.LM125:
 973               	.LFBB14:
 974 02f0 CF93      		push r28
 975 02f2 DF93      		push r29
 976               	/* prologue: function */
 977               	/* frame size = 0 */
 978               	/* stack size = 2 */
 979               	.L__stack_usage = 2
 363:main.c        ****     uint8_t rx_flag = 0;
 364:main.c        ****     uint8_t received_cnt = 0;
 365:main.c        ****     uint8_t check_cnt = 0;
 366:main.c        ****     uint8_t limit = 30;
 367:main.c        ****     uint8_t _ = 0;
 368:main.c        **** 
 369:main.c        ****     cli();
 980               		.stabn	68,0,369,.LM126-.LFBB14
 981               	.LM126:
 982               	/* #APP */
 983               	 ;  369 "main.c" 1
 984 02f4 F894      		cli
 985               	 ;  0 "" 2
 365:main.c        ****     uint8_t limit = 30;
GAS LISTING /tmp/ccsBKM5i.s 			page 26


 986               		.stabn	68,0,365,.LM127-.LFBB14
 987               	.LM127:
 988               	/* #NOAPP */
 989 02f6 D0E0      		ldi r29,0
 364:main.c        ****     uint8_t check_cnt = 0;
 990               		.stabn	68,0,364,.LM128-.LFBB14
 991               	.LM128:
 992 02f8 C0E0      		ldi r28,0
 993               	.L75:
 370:main.c        ****     while ((received_cnt < limit) && check_cnt < 2) {
 371:main.c        ****         if ((UCSR0A & (1<<RXC0))) {
 994               		.stabn	68,0,371,.LM129-.LFBB14
 995               	.LM129:
 996 02fa 8091 C000 		lds r24,192
 997 02fe 87FF      		sbrs r24,7
 998 0300 00C0      		rjmp .L72
 372:main.c        ****             received_cnt++;
 999               		.stabn	68,0,372,.LM130-.LFBB14
 1000               	.LM130:
 1001 0302 CF5F      		subi r28,lo8(-(1))
 373:main.c        ****             _ = UDR0;
 1002               		.stabn	68,0,373,.LM131-.LFBB14
 1003               	.LM131:
 1004 0304 8091 C600 		lds r24,198
 1005               	.L73:
 374:main.c        ****             ++_; /* Para parar o warning do compilador */
 375:main.c        ****         } else {
 376:main.c        ****             check_cnt++;
 377:main.c        ****         }
 378:main.c        ****         delay_ms(2);
 1006               		.stabn	68,0,378,.LM132-.LFBB14
 1007               	.LM132:
 1008 0308 82E0      		ldi r24,lo8(2)
 1009 030a 90E0      		ldi r25,0
 1010 030c 0E94 0000 		call delay_ms
 370:main.c        ****         if ((UCSR0A & (1<<RXC0))) {
 1011               		.stabn	68,0,370,.LM133-.LFBB14
 1012               	.LM133:
 1013 0310 CE31      		cpi r28,lo8(30)
 1014 0312 01F0      		breq .L74
 370:main.c        ****         if ((UCSR0A & (1<<RXC0))) {
 1015               		.stabn	68,0,370,.LM134-.LFBB14
 1016               	.LM134:
 1017 0314 D230      		cpi r29,lo8(2)
 1018 0316 01F4      		brne .L75
 1019               	.L74:
 379:main.c        ****     }
 380:main.c        ****     sei();
 1020               		.stabn	68,0,380,.LM135-.LFBB14
 1021               	.LM135:
 1022               	/* #APP */
 1023               	 ;  380 "main.c" 1
 1024 0318 7894      		sei
 1025               	 ;  0 "" 2
 381:main.c        ****     rx_flag = received_cnt < limit ? 0 : 1;
 1026               		.stabn	68,0,381,.LM136-.LFBB14
 1027               	.LM136:
GAS LISTING /tmp/ccsBKM5i.s 			page 27


 1028               	/* #NOAPP */
 1029 031a 81E0      		ldi r24,lo8(1)
 1030 031c CE31      		cpi r28,lo8(30)
 1031 031e 00F4      		brsh .L76
 1032 0320 80E0      		ldi r24,0
 1033               	.L76:
 1034               	/* epilogue start */
 382:main.c        ****     return rx_flag;
 383:main.c        **** }
 1035               		.stabn	68,0,383,.LM137-.LFBB14
 1036               	.LM137:
 1037 0322 DF91      		pop r29
 1038 0324 CF91      		pop r28
 1039 0326 0895      		ret
 1040               	.L72:
 376:main.c        ****         }
 1041               		.stabn	68,0,376,.LM138-.LFBB14
 1042               	.LM138:
 1043 0328 DF5F      		subi r29,lo8(-(1))
 1044 032a 00C0      		rjmp .L73
 1045               		.size	received_data, .-received_data
 1046               		.stabs	"received_cnt:r(5,2)",64,0,364,28
 1047               		.stabs	"check_cnt:r(5,2)",64,0,365,29
 1048               		.stabs	"_:r(5,2)",64,0,367,24
 1049               		.stabn	192,0,0,.LFBB14-.LFBB14
 1050               		.stabn	224,0,0,.Lscope14-.LFBB14
 1051               	.Lscope14:
 1052               		.stabs	"",36,0,0,.Lscope14-.LFBB14
 1053               		.stabd	78,0,0
 1054               		.stabs	"reset_rxbuffer:F(0,50)",36,0,385,reset_rxbuffer
 1055               	.global	reset_rxbuffer
 1056               		.type	reset_rxbuffer, @function
 1057               	reset_rxbuffer:
 1058               		.stabd	46,0,0
 384:main.c        **** 
 385:main.c        **** void reset_rxbuffer(void) {
 1059               		.stabn	68,0,385,.LM139-.LFBB15
 1060               	.LM139:
 1061               	.LFBB15:
 1062               	/* prologue: function */
 1063               	/* frame size = 0 */
 1064               	/* stack size = 0 */
 1065               	.L__stack_usage = 0
 386:main.c        ****     cli();
 1066               		.stabn	68,0,386,.LM140-.LFBB15
 1067               	.LM140:
 1068               	/* #APP */
 1069               	 ;  386 "main.c" 1
 1070 032c F894      		cli
 1071               	 ;  0 "" 2
 387:main.c        ****     memset(rx_buffer, 0, sizeof(rx_buffer));
 1072               		.stabn	68,0,387,.LM141-.LFBB15
 1073               	.LM141:
 1074               	/* #NOAPP */
 1075 032e E0E0      		ldi r30,lo8(rx_buffer)
 1076 0330 F0E0      		ldi r31,hi8(rx_buffer)
 1077 0332 8FEF      		ldi r24,lo8(-1)
GAS LISTING /tmp/ccsBKM5i.s 			page 28


 1078 0334 DF01      		movw r26,r30
 1079               		0:
 1080 0336 1D92      		st X+,__zero_reg__
 1081 0338 8A95      		dec r24
 1082 033a 01F4      		brne 0b
 388:main.c        ****     rx_head = 0;
 1083               		.stabn	68,0,388,.LM142-.LFBB15
 1084               	.LM142:
 1085 033c 1092 0000 		sts rx_head,__zero_reg__
 389:main.c        ****     rx_tail = 0;
 1086               		.stabn	68,0,389,.LM143-.LFBB15
 1087               	.LM143:
 1088 0340 1092 0000 		sts rx_tail,__zero_reg__
 390:main.c        ****     rcvd_byte = 0;
 1089               		.stabn	68,0,390,.LM144-.LFBB15
 1090               	.LM144:
 1091 0344 1092 0000 		sts rcvd_byte,__zero_reg__
 391:main.c        ****     sei();
 1092               		.stabn	68,0,391,.LM145-.LFBB15
 1093               	.LM145:
 1094               	/* #APP */
 1095               	 ;  391 "main.c" 1
 1096 0348 7894      		sei
 1097               	 ;  0 "" 2
 1098               	/* epilogue start */
 392:main.c        **** }...
 1099               		.stabn	68,0,392,.LM146-.LFBB15
 1100               	.LM146:
 1101               	/* #NOAPP */
 1102 034a 0895      		ret
 1103               		.size	reset_rxbuffer, .-reset_rxbuffer
 1104               	.Lscope15:
 1105               		.stabs	"",36,0,0,.Lscope15-.LFBB15
 1106               		.stabd	78,0,0
 1107               		.section	.rodata.str1.1,"aMS",@progbits,1
 1108               	.LC1:
 1109 0000 556E 6976 		.string	"Universidade Federal de Pernambuco\nDepartamento de Eletr\303\264nica e Sistemas"
 1109      6572 7369 
 1109      6461 6465 
 1109      2046 6564 
 1109      6572 616C 
 1110               		.section	.rodata
 1111               	.LC0:
 1112 0000 00        		.byte	0
 1113 0001 01        		.byte	1
 1114 0002 11        		.byte	17
 1115 0003 02        		.byte	2
 1116 0004 13        		.byte	19
 1117 0005 04        		.byte	4
 1118 0006 7E        		.byte	126
 1119 0007 05        		.byte	5
 1120 0008 7D        		.byte	125
 1121 0009 06        		.byte	6
 1122               		.section	.rodata.str1.1
 1123               	.LC2:
 1124 004a 4465 7365 		.string	"Desenvolvimento de sistemas embarcados"
 1124      6E76 6F6C 
GAS LISTING /tmp/ccsBKM5i.s 			page 29


 1124      7669 6D65 
 1124      6E74 6F20 
 1124      6465 2073 
 1125               		.section	.text.startup,"ax",@progbits
 1126               		.stabs	"main:F(0,1)",36,0,91,main
 1127               	.global	main
 1128               		.type	main, @function
 1129               	main:
 1130               		.stabd	46,0,0
  91:main.c        **** int main(void) {
 1131               		.stabn	68,0,91,.LM147-.LFBB16
 1132               	.LM147:
 1133               	.LFBB16:
 1134 0000 CF93      		push r28
 1135 0002 DF93      		push r29
 1136 0004 CDB7      		in r28,__SP_L__
 1137 0006 DEB7      		in r29,__SP_H__
 1138 0008 C15A      		subi r28,-95
 1139 000a D140      		sbci r29,1
 1140 000c 0FB6      		in __tmp_reg__,__SREG__
 1141 000e F894      		cli
 1142 0010 DEBF      		out __SP_H__,r29
 1143 0012 0FBE      		out __SREG__,__tmp_reg__
 1144 0014 CDBF      		out __SP_L__,r28
 1145               	/* prologue: function */
 1146               	/* frame size = 417 */
 1147               	/* stack size = 419 */
 1148               	.L__stack_usage = 419
  94:main.c        ****     UCSR0A = (1 << U2X0); /* double speed */
 1149               		.stabn	68,0,94,.LM148-.LFBB16
 1150               	.LM148:
 1151 0016 82E0      		ldi r24,lo8(2)
 1152 0018 8093 C000 		sts 192,r24
  95:main.c        ****     UCSR0B = (1<<RXEN0) | (1 << TXEN0) | (1 << RXCIE0); /* Enable rx and tx, rx complete interrupt 
 1153               		.stabn	68,0,95,.LM149-.LFBB16
 1154               	.LM149:
 1155 001c 88E9      		ldi r24,lo8(-104)
 1156 001e 8093 C100 		sts 193,r24
  96:main.c        ****     UCSR0C = (1<<UCSZ01) | (1<<UCSZ00); /* Set frame format: 8N1 */
 1157               		.stabn	68,0,96,.LM150-.LFBB16
 1158               	.LM150:
 1159 0022 86E0      		ldi r24,lo8(6)
 1160 0024 8093 C200 		sts 194,r24
  97:main.c        ****     UBRR0H = (MYUBRR>>8); /* Set baud rate */
 1161               		.stabn	68,0,97,.LM151-.LFBB16
 1162               	.LM151:
 1163 0028 1092 C500 		sts 197,__zero_reg__
  98:main.c        ****     UBRR0L = MYUBRR; /* Set baud rate */
 1164               		.stabn	68,0,98,.LM152-.LFBB16
 1165               	.LM152:
 1166 002c 8FEC      		ldi r24,lo8(-49)
 1167 002e 8093 C400 		sts 196,r24
 100:main.c        ****     DDRB |= (1 << PB5); // Configura PB5 como sa√≠da (LED)
 1168               		.stabn	68,0,100,.LM153-.LFBB16
 1169               	.LM153:
 1170 0032 259A      		sbi 0x4,5
 101:main.c        ****     PORTB &= ~(1 << PB5); // Garante que o LED est√° apagado no in√≠cio   
GAS LISTING /tmp/ccsBKM5i.s 			page 30


 1171               		.stabn	68,0,101,.LM154-.LFBB16
 1172               	.LM154:
 1173 0034 2D98      		cbi 0x5,5
 103:main.c        ****     sei();
 1174               		.stabn	68,0,103,.LM155-.LFBB16
 1175               	.LM155:
 1176               	/* #APP */
 1177               	 ;  103 "main.c" 1
 1178 0036 7894      		sei
 1179               	 ;  0 "" 2
 108:main.c        ****     uint8_t str_test[] = "Universidade Federal de Pernambuco\nDepartamento de Eletr√¥nica e Sistema
 1180               		.stabn	68,0,108,.LM156-.LFBB16
 1181               	.LM156:
 1182               	/* #NOAPP */
 1183 0038 8AE4      		ldi r24,lo8(74)
 1184 003a E0E0      		ldi r30,lo8(.LC1)
 1185 003c F0E0      		ldi r31,hi8(.LC1)
 1186 003e DE01      		movw r26,r28
 1187 0040 B395      		inc r27
 1188               		0:
 1189 0042 0190      		ld r0,Z+
 1190 0044 0D92      		st X+,r0
 1191 0046 8A95      		dec r24
 1192 0048 01F4      		brne 0b
 109:main.c        ****     write(str_test, sizeof(str_test)-1, 1);
 1193               		.stabn	68,0,109,.LM157-.LFBB16
 1194               	.LM157:
 1195 004a 41E0      		ldi r20,lo8(1)
 1196 004c 69E4      		ldi r22,lo8(73)
 1197 004e CE01      		movw r24,r28
 1198 0050 9395      		inc r25
 1199 0052 0E94 0000 		call write
 111:main.c        ****     delay_ms(1000); /* Delay necess√°rio para o c√≥digo de teste */
 1200               		.stabn	68,0,111,.LM158-.LFBB16
 1201               	.LM158:
 1202 0056 88EE      		ldi r24,lo8(-24)
 1203 0058 93E0      		ldi r25,lo8(3)
 1204 005a 0E94 0000 		call delay_ms
 115:main.c        ****     uint8_t j = 0;
 1205               		.stabn	68,0,115,.LM159-.LFBB16
 1206               	.LM159:
 1207 005e 00E0      		ldi r16,0
 114:main.c        ****     uint8_t i = sizeof(str_test);
 1208               		.stabn	68,0,114,.LM160-.LFBB16
 1209               	.LM160:
 1210 0060 1AE4      		ldi r17,lo8(74)
 1211               	.L83:
 118:main.c        ****             i -= write(str_test+j, 10, 0);
 1212               		.stabn	68,0,118,.LM161-.LFBB16
 1213               	.LM161:
 1214 0062 40E0      		ldi r20,0
 1215 0064 6AE0      		ldi r22,lo8(10)
 1216 0066 80E0      		ldi r24,0
 1217 0068 91E0      		ldi r25,lo8(1)
 1218 006a 8C0F      		add r24,r28
 1219 006c 9D1F      		adc r25,r29
 1220 006e 800F      		add r24,r16
GAS LISTING /tmp/ccsBKM5i.s 			page 31


 1221 0070 911D      		adc r25,__zero_reg__
 1222 0072 0E94 0000 		call write
 1223 0076 181B      		sub r17,r24
 119:main.c        ****             j += 10;
 1224               		.stabn	68,0,119,.LM162-.LFBB16
 1225               	.LM162:
 1226 0078 065F      		subi r16,lo8(-(10))
 116:main.c        ****     while (i) {
 1227               		.stabn	68,0,116,.LM163-.LFBB16
 1228               	.LM163:
 1229 007a 1111      		cpse r17,__zero_reg__
 1230 007c 00C0      		rjmp .L85
 1231               	.L86:
 127:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 1232               		.stabn	68,0,127,.LM164-.LFBB16
 1233               	.LM164:
 1234 007e 0E94 0000 		call reset_rxbuffer
 128:main.c        ****     uint16_t nbytes = 0;
 1235               		.stabn	68,0,128,.LM165-.LFBB16
 1236               	.LM165:
 1237 0082 10E0      		ldi r17,0
 1238 0084 00E0      		ldi r16,0
 131:main.c        ****         nbytes += read(buffer, 300-nbytes > 254 ? 254 : 300-nbytes) - 1; /* Conferir se precisa des
 1239               		.stabn	68,0,131,.LM166-.LFBB16
 1240               	.LM166:
 1241 0086 9CE2      		ldi r25,lo8(44)
 1242 0088 E92E      		mov r14,r25
 1243 008a FF24      		clr r15
 1244 008c F394      		inc r15
 1245               	.L88:
 1246 008e B701      		movw r22,r14
 1247 0090 601B      		sub r22,r16
 1248 0092 710B      		sbc r23,r17
 1249 0094 6F3F      		cpi r22,-1
 1250 0096 7105      		cpc r23,__zero_reg__
 1251 0098 00F0      		brlo .L87
 1252 009a 6EEF      		ldi r22,lo8(-2)
 1253 009c 70E0      		ldi r23,0
 1254               	.L87:
 1255 009e CE01      		movw r24,r28
 1256 00a0 0196      		adiw r24,1
 1257 00a2 0E94 0000 		call read
 1258 00a6 8150      		subi r24,1
 1259 00a8 990B      		sbc r25,r25
 1260 00aa 080F      		add r16,r24
 1261 00ac 191F      		adc r17,r25
 130:main.c        ****     while (nbytes < 300) {
 1262               		.stabn	68,0,130,.LM167-.LFBB16
 1263               	.LM167:
 1264 00ae 0C32      		cpi r16,44
 1265 00b0 81E0      		ldi r24,1
 1266 00b2 1807      		cpc r17,r24
 1267 00b4 00F0      		brlo .L88
 133:main.c        ****     flow_off();
 1268               		.stabn	68,0,133,.LM168-.LFBB16
 1269               	.LM168:
 1270 00b6 0E94 0000 		call flow_off
GAS LISTING /tmp/ccsBKM5i.s 			page 32


 134:main.c        ****     if (received_data()) {
 1271               		.stabn	68,0,134,.LM169-.LFBB16
 1272               	.LM169:
 1273 00ba 0E94 0000 		call received_data
 1274 00be 8823      		tst r24
 1275 00c0 01F4      		brne .+2
 1276 00c2 00C0      		rjmp .L89
 135:main.c        ****         turn_led_on();
 1277               		.stabn	68,0,135,.LM170-.LFBB16
 1278               	.LM170:
 1279 00c4 0E94 0000 		call turn_led_on
 1280               	.L90:
 141:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 1281               		.stabn	68,0,141,.LM171-.LFBB16
 1282               	.LM171:
 1283 00c8 0E94 0000 		call reset_rxbuffer
 142:main.c        ****     flow_on(); /* Precisa do flow_on()? */
 1284               		.stabn	68,0,142,.LM172-.LFBB16
 1285               	.LM172:
 1286 00cc 0E94 0000 		call flow_on
 143:main.c        ****     PORTB &= ~(1 << PB5); /* Apaga o LED */
 1287               		.stabn	68,0,143,.LM173-.LFBB16
 1288               	.LM173:
 1289 00d0 2D98      		cbi 0x5,5
 144:main.c        ****     nbytes = 0;
 1290               		.stabn	68,0,144,.LM174-.LFBB16
 1291               	.LM174:
 1292 00d2 10E0      		ldi r17,0
 1293 00d4 00E0      		ldi r16,0
 146:main.c        ****         nbytes += read(buffer, 300-nbytes > 254 ? 254 : 300-nbytes) - 1; /* Conferir se precisa des
 1294               		.stabn	68,0,146,.LM175-.LFBB16
 1295               	.LM175:
 1296 00d6 8CE2      		ldi r24,lo8(44)
 1297 00d8 E82E      		mov r14,r24
 1298 00da FF24      		clr r15
 1299 00dc F394      		inc r15
 1300               	.L92:
 1301 00de B701      		movw r22,r14
 1302 00e0 601B      		sub r22,r16
 1303 00e2 710B      		sbc r23,r17
 1304 00e4 6F3F      		cpi r22,-1
 1305 00e6 7105      		cpc r23,__zero_reg__
 1306 00e8 00F0      		brlo .L91
 1307 00ea 6EEF      		ldi r22,lo8(-2)
 1308 00ec 70E0      		ldi r23,0
 1309               	.L91:
 1310 00ee CE01      		movw r24,r28
 1311 00f0 0196      		adiw r24,1
 1312 00f2 0E94 0000 		call read
 1313 00f6 8150      		subi r24,1
 1314 00f8 990B      		sbc r25,r25
 1315 00fa 080F      		add r16,r24
 1316 00fc 191F      		adc r17,r25
 145:main.c        ****     while (nbytes < 300) {
 1317               		.stabn	68,0,145,.LM176-.LFBB16
 1318               	.LM176:
 1319 00fe 0C32      		cpi r16,44
GAS LISTING /tmp/ccsBKM5i.s 			page 33


 1320 0100 E1E0      		ldi r30,1
 1321 0102 1E07      		cpc r17,r30
 1322 0104 00F0      		brlo .L92
 149:main.c        ****     flow_off();
 1323               		.stabn	68,0,149,.LM177-.LFBB16
 1324               	.LM177:
 1325 0106 0E94 0000 		call flow_off
 150:main.c        ****     if (received_data()) {
 1326               		.stabn	68,0,150,.LM178-.LFBB16
 1327               	.LM178:
 1328 010a 0E94 0000 		call received_data
 1329 010e 8823      		tst r24
 1330 0110 01F4      		brne .+2
 1331 0112 00C0      		rjmp .L93
 151:main.c        ****         turn_led_on();
 1332               		.stabn	68,0,151,.LM179-.LFBB16
 1333               	.LM179:
 1334 0114 0E94 0000 		call turn_led_on
 1335               	.L94:
 157:main.c        ****     flow_on(); /* Precisa do flow_on()? */
 1336               		.stabn	68,0,157,.LM180-.LFBB16
 1337               	.LM180:
 1338 0118 0E94 0000 		call flow_on
 158:main.c        ****     PORTB &= ~(1 << PB5); /* Apaga o LED */
 1339               		.stabn	68,0,158,.LM181-.LFBB16
 1340               	.LM181:
 1341 011c 2D98      		cbi 0x5,5
 160:main.c        ****     uint8_t binary_string[] = {0x00, 0x01, 0x11, 0x02, 0x13, 0x04, 0x7e, 0x05, 0x7d, 0x06};
 1342               		.stabn	68,0,160,.LM182-.LFBB16
 1343               	.LM182:
 1344 011e 8AE0      		ldi r24,lo8(10)
 1345 0120 E0E0      		ldi r30,lo8(.LC0)
 1346 0122 F0E0      		ldi r31,hi8(.LC0)
 1347 0124 DE01      		movw r26,r28
 1348 0126 A856      		subi r26,104
 1349 0128 BE4F      		sbci r27,-2
 1350               		0:
 1351 012a 0190      		ld r0,Z+
 1352 012c 0D92      		st X+,r0
 1353 012e 8A95      		dec r24
 1354 0130 01F4      		brne 0b
 161:main.c        ****     i = 0;
 1355               		.stabn	68,0,161,.LM183-.LFBB16
 1356               	.LM183:
 1357 0132 10E0      		ldi r17,0
 1358               	.L97:
 165:main.c        ****         if (!write(binary_string+i, 1, 0)) {
 1359               		.stabn	68,0,165,.LM184-.LFBB16
 1360               	.LM184:
 1361 0134 40E0      		ldi r20,0
 1362 0136 61E0      		ldi r22,lo8(1)
 1363 0138 88E9      		ldi r24,lo8(-104)
 1364 013a 91E0      		ldi r25,lo8(1)
 1365 013c 8C0F      		add r24,r28
 1366 013e 9D1F      		adc r25,r29
 1367 0140 810F      		add r24,r17
 1368 0142 911D      		adc r25,__zero_reg__
GAS LISTING /tmp/ccsBKM5i.s 			page 34


 1369 0144 0E94 0000 		call write
 1370 0148 8111      		cpse r24,__zero_reg__
 1371 014a 00C0      		rjmp .L95
 166:main.c        ****             PORTB |= (1 << PB5); /* Acende o LED */
 1372               		.stabn	68,0,166,.LM185-.LFBB16
 1373               	.LM185:
 1374 014c 2D9A      		sbi 0x5,5
 1375               	.L96:
 164:main.c        ****     while (i < sizeof(binary_string)) { 
 1376               		.stabn	68,0,164,.LM186-.LFBB16
 1377               	.LM186:
 1378 014e 1A30      		cpi r17,lo8(10)
 1379 0150 01F4      		brne .L97
 174:main.c        ****     reset_rxbuffer(); /* Limpa o buffer de rx */
 1380               		.stabn	68,0,174,.LM187-.LFBB16
 1381               	.LM187:
 1382 0152 0E94 0000 		call reset_rxbuffer
 175:main.c        ****     uint8_t comp_str[] = "Desenvolvimento de sistemas embarcados";
 1383               		.stabn	68,0,175,.LM188-.LFBB16
 1384               	.LM188:
 1385 0156 8E01      		movw r16,r28
 1386 0158 0F58      		subi r16,-113
 1387 015a 1E4F      		sbci r17,-2
 1388 015c 87E2      		ldi r24,lo8(39)
 1389 015e E0E0      		ldi r30,lo8(.LC2)
 1390 0160 F0E0      		ldi r31,hi8(.LC2)
 1391 0162 D801      		movw r26,r16
 1392               		0:
 1393 0164 0190      		ld r0,Z+
 1394 0166 0D92      		st X+,r0
 1395 0168 8A95      		dec r24
 1396 016a 01F4      		brne 0b
 1397               	.L98:
 182:main.c        ****         read(comp_buffer, 254);
 1398               		.stabn	68,0,182,.LM189-.LFBB16
 1399               	.LM189:
 1400 016c 6EEF      		ldi r22,lo8(-2)
 1401 016e CE01      		movw r24,r28
 1402 0170 865B      		subi r24,-74
 1403 0172 9E4F      		sbci r25,-2
 1404 0174 0E94 0000 		call read
 191:main.c        ****         if (memcmp(comp_buffer, comp_str, strlen((const char *)comp_str)+1) == 0) {
 1405               		.stabn	68,0,191,.LM190-.LFBB16
 1406               	.LM190:
 1407 0178 F801      		movw r30,r16
 1408               		0:
 1409 017a 0190      		ld __tmp_reg__,Z+
 1410 017c 0020      		tst __tmp_reg__
 1411 017e 01F4      		brne 0b
 1412 0180 AF01      		movw r20,r30
 1413 0182 401B      		sub r20,r16
 1414 0184 510B      		sbc r21,r17
 1415 0186 B801      		movw r22,r16
 1416 0188 CE01      		movw r24,r28
 1417 018a 865B      		subi r24,-74
 1418 018c 9E4F      		sbci r25,-2
 1419 018e 0E94 0000 		call memcmp
GAS LISTING /tmp/ccsBKM5i.s 			page 35


 1420 0192 892B      		or r24,r25
 1421 0194 01F4      		brne .L99
 192:main.c        ****             PORTB |= (1 << PB5);
 1422               		.stabn	68,0,192,.LM191-.LFBB16
 1423               	.LM191:
 1424 0196 2D9A      		sbi 0x5,5
 1425               	.L101:
 161:main.c        ****     i = 0;
 1426               		.stabn	68,0,161,.LM192-.LFBB16
 1427               	.LM192:
 1428 0198 F12C      		mov r15,__zero_reg__
 1429               	.L100:
 199:main.c        ****         while (read(comp_buffer+k, 10) == 11) {
 1430               		.stabn	68,0,199,.LM193-.LFBB16
 1431               	.LM193:
 1432 019a 6AE0      		ldi r22,lo8(10)
 1433 019c 8AE4      		ldi r24,lo8(74)
 1434 019e 91E0      		ldi r25,lo8(1)
 1435 01a0 8C0F      		add r24,r28
 1436 01a2 9D1F      		adc r25,r29
 1437 01a4 8F0D      		add r24,r15
 1438 01a6 911D      		adc r25,__zero_reg__
 1439 01a8 0E94 0000 		call read
 1440 01ac 8B30      		cpi r24,lo8(11)
 1441 01ae 01F0      		breq .L102
 210:main.c        ****         if (memcmp(comp_buffer, comp_str, strlen((const char *)comp_str)+1) == 0) {
 1442               		.stabn	68,0,210,.LM194-.LFBB16
 1443               	.LM194:
 1444 01b0 F801      		movw r30,r16
 1445               		0:
 1446 01b2 0190      		ld __tmp_reg__,Z+
 1447 01b4 0020      		tst __tmp_reg__
 1448 01b6 01F4      		brne 0b
 1449 01b8 AF01      		movw r20,r30
 1450 01ba 401B      		sub r20,r16
 1451 01bc 510B      		sbc r21,r17
 1452 01be B801      		movw r22,r16
 1453 01c0 CE01      		movw r24,r28
 1454 01c2 865B      		subi r24,-74
 1455 01c4 9E4F      		sbci r25,-2
 1456 01c6 0E94 0000 		call memcmp
 1457 01ca 892B      		or r24,r25
 1458 01cc 01F4      		brne .L103
 211:main.c        ****             PORTB |= (1 << PB5);
 1459               		.stabn	68,0,211,.LM195-.LFBB16
 1460               	.LM195:
 1461 01ce 2D9A      		sbi 0x5,5
 1462 01d0 00C0      		rjmp .L98
 1463               	.L85:
 117:main.c        ****         if (i >= 10) {
 1464               		.stabn	68,0,117,.LM196-.LFBB16
 1465               	.LM196:
 1466 01d2 1A30      		cpi r17,lo8(10)
 1467 01d4 00F0      		brlo .+2
 1468 01d6 00C0      		rjmp .L83
 121:main.c        ****             write(str_test+j, i-1, 1);
 1469               		.stabn	68,0,121,.LM197-.LFBB16
GAS LISTING /tmp/ccsBKM5i.s 			page 36


 1470               	.LM197:
 1471 01d8 6FEF      		ldi r22,lo8(-1)
 1472 01da 610F      		add r22,r17
 1473 01dc 41E0      		ldi r20,lo8(1)
 1474 01de 80E0      		ldi r24,0
 1475 01e0 91E0      		ldi r25,lo8(1)
 1476 01e2 8C0F      		add r24,r28
 1477 01e4 9D1F      		adc r25,r29
 1478 01e6 800F      		add r24,r16
 1479 01e8 911D      		adc r25,__zero_reg__
 1480 01ea 0E94 0000 		call write
 1481 01ee 00C0      		rjmp .L86
 1482               	.L89:
 137:main.c        ****         blink_led();
 1483               		.stabn	68,0,137,.LM198-.LFBB16
 1484               	.LM198:
 1485 01f0 0E94 0000 		call blink_led
 1486 01f4 00C0      		rjmp .L90
 1487               	.L93:
 153:main.c        ****         blink_led();
 1488               		.stabn	68,0,153,.LM199-.LFBB16
 1489               	.LM199:
 1490 01f6 0E94 0000 		call blink_led
 1491 01fa 00C0      		rjmp .L94
 1492               	.L95:
 168:main.c        ****             PORTB &= ~(1 << PB5); /* Apaga o LED */
 1493               		.stabn	68,0,168,.LM200-.LFBB16
 1494               	.LM200:
 1495 01fc 2D98      		cbi 0x5,5
 169:main.c        ****             i++;
 1496               		.stabn	68,0,169,.LM201-.LFBB16
 1497               	.LM201:
 1498 01fe 1F5F      		subi r17,lo8(-(1))
 1499 0200 00C0      		rjmp .L96
 1500               	.L99:
 194:main.c        ****             PORTB &= ~(1 << PB5);
 1501               		.stabn	68,0,194,.LM202-.LFBB16
 1502               	.LM202:
 1503 0202 2D98      		cbi 0x5,5
 1504 0204 00C0      		rjmp .L101
 1505               	.L102:
 200:main.c        ****             k += 10;
 1506               		.stabn	68,0,200,.LM203-.LFBB16
 1507               	.LM203:
 1508 0206 FAE0      		ldi r31,lo8(10)
 1509 0208 FF0E      		add r15,r31
 1510 020a 00C0      		rjmp .L100
 1511               	.L103:
 213:main.c        ****             PORTB &= ~(1 << PB5);
 1512               		.stabn	68,0,213,.LM204-.LFBB16
 1513               	.LM204:
 1514 020c 2D98      		cbi 0x5,5
 1515 020e 00C0      		rjmp .L98
 1516               		.size	main, .-main
 1517               		.stabs	"str_test:(0,52)=ar(0,53)=r(0,53);0;0177777;;0;73;(5,2)",128,0,108,256
 1518               		.stabs	"j:r(5,2)",64,0,115,16
 1519               		.stabs	"buffer:(0,54)=ar(0,53);0;254;(5,2)",128,0,129,1
GAS LISTING /tmp/ccsBKM5i.s 			page 37


 1520               		.stabs	"binary_string:(0,55)=ar(0,53);0;9;(5,2)",128,0,160,408
 1521               		.stabs	"comp_str:(0,56)=ar(0,53);0;38;(5,2)",128,0,175,369
 1522               		.stabs	"comp_buffer:(0,56)",128,0,176,330
 1523               		.stabs	"k:r(5,2)",64,0,177,15
 1524               		.stabn	192,0,0,.LFBB16-.LFBB16
 1525               		.stabn	224,0,0,.Lscope16-.LFBB16
 1526               	.Lscope16:
 1527               		.stabs	"",36,0,0,.Lscope16-.LFBB16
 1528               		.stabd	78,0,0
 1529               	.global	rcvd_byte
 1530               		.section .bss
 1531               		.type	rcvd_byte, @object
 1532               		.size	rcvd_byte, 1
 1533               	rcvd_byte:
 1534 0000 00        		.zero	1
 1535               		.stabs	"rcvd_byte:G(0,57)=B(5,2)",32,0,51,0
 1536               		.comm	usart_transmitting,1,1
 1537               		.stabs	"usart_transmitting:G(5,2)",32,0,49,0
 1538               		.comm	tx_tail,1,1
 1539               		.stabs	"tx_tail:G(5,2)",32,0,48,0
 1540               		.comm	tx_head,1,1
 1541               		.stabs	"tx_head:G(5,2)",32,0,48,0
 1542               		.comm	tx_buffer,255,1
 1543               		.stabs	"tx_buffer:G(0,54)",32,0,47,0
 1544               		.comm	rx_tail,1,1
 1545               		.stabs	"rx_tail:G(5,2)",32,0,46,0
 1546               		.comm	rx_head,1,1
 1547               		.stabs	"rx_head:G(5,2)",32,0,46,0
 1548               		.comm	rx_buffer,255,1
 1549               		.stabs	"rx_buffer:G(0,54)",32,0,45,0
 1550               	.global	tx_state
 1551               		.data
 1552               		.type	tx_state, @object
 1553               		.size	tx_state, 1
 1554               	tx_state:
 1555 0000 01        		.byte	1
 1556               		.stabs	"tx_state:G(5,2)",32,0,44,0
 1557               		.comm	rx_sinc,1,1
 1558               		.stabs	"rx_sinc:G(5,2)",32,0,44,0
 1559               	.global	rx_state
 1560               		.type	rx_state, @object
 1561               		.size	rx_state, 1
 1562               	rx_state:
 1563 0001 01        		.byte	1
 1564               		.stabs	"rx_state:G(5,2)",32,0,44,0
 1565               		.comm	rx_esc,1,1
 1566               		.stabs	"rx_esc:G(5,2)",32,0,44,0
 1567               		.comm	tx_byte_cnt,1,1
 1568               		.stabs	"tx_byte_cnt:G(5,2)",32,0,43,0
 1569               		.comm	rx_byte_cnt,1,1
 1570               		.stabs	"rx_byte_cnt:G(5,2)",32,0,43,0
 1571               		.text
 1572               		.stabs	"",100,0,0,.Letext0
 1573               	.Letext0:
 1574               		.ident	"GCC: (GNU) 7.3.0"
 1575               	.global __do_copy_data
 1576               	.global __do_clear_bss
GAS LISTING /tmp/ccsBKM5i.s 			page 38


GAS LISTING /tmp/ccsBKM5i.s 			page 39


DEFINED SYMBOLS
                            *ABS*:0000000000000000 main.c
     /tmp/ccsBKM5i.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccsBKM5i.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccsBKM5i.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccsBKM5i.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccsBKM5i.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccsBKM5i.s:113    .text:0000000000000000 __vector_19
                            *COM*:0000000000000001 tx_tail
                            *COM*:0000000000000001 tx_head
                            *COM*:0000000000000001 usart_transmitting
                            *COM*:00000000000000ff tx_buffer
     /tmp/ccsBKM5i.s:186    .text:000000000000005c read_rx_buffer
                            *COM*:0000000000000001 rx_tail
                            *COM*:0000000000000001 rx_head
                            *COM*:00000000000000ff rx_buffer
     /tmp/ccsBKM5i.s:264    .text:0000000000000092 read
     /tmp/ccsBKM5i.s:1562   .data:0000000000000001 rx_state
     /tmp/ccsBKM5i.s:1533   .bss:0000000000000000 rcvd_byte
                            *COM*:0000000000000001 rx_sinc
     /tmp/ccsBKM5i.s:361    .text:00000000000000ea write_tx_buffer
     /tmp/ccsBKM5i.s:467    .text:0000000000000138 write
                            *COM*:0000000000000001 tx_byte_cnt
     /tmp/ccsBKM5i.s:1554   .data:0000000000000000 tx_state
     /tmp/ccsBKM5i.s:572    .text:00000000000001bc enqueue_rx_buffer
     /tmp/ccsBKM5i.s:642    .text:00000000000001f6 __vector_18
                            *COM*:0000000000000001 rx_esc
     /tmp/ccsBKM5i.s:762    .text:0000000000000286 flow_off
     /tmp/ccsBKM5i.s:789    .text:0000000000000292 flow_on
     /tmp/ccsBKM5i.s:817    .text:00000000000002a0 is_flow_on
     /tmp/ccsBKM5i.s:839    .text:00000000000002a6 delay_ms
     /tmp/ccsBKM5i.s:893    .text:00000000000002c4 blink_led
     /tmp/ccsBKM5i.s:938    .text:00000000000002e2 turn_led_on
     /tmp/ccsBKM5i.s:969    .text:00000000000002f0 received_data
     /tmp/ccsBKM5i.s:1057   .text:000000000000032c reset_rxbuffer
     /tmp/ccsBKM5i.s:1129   .text.startup:0000000000000000 main
                            *COM*:0000000000000001 rx_byte_cnt

UNDEFINED SYMBOLS
memcmp
__do_copy_data
__do_clear_bss
